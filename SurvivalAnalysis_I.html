<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Madawa Jayawardana" />


<title>Survival Analysis Using R - Part I</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Introduction to Survival Analysis</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="SurvivalAnalysis_I.html">Material</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/PMacDaSci/survival-analysis-intro">
    <span class="fab fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Survival Analysis Using R - Part I</h1>
<h3 class="subtitle">What is survival analysis? KM curves and log-rank tests</h3>
<h4 class="author">Madawa Jayawardana</h4>

</div>


<div id="introduction" class="section level1">
<h1>Introduction</h1>
<blockquote>
<p>Welcome! This is the part I of the workshop series on survival analysis. This will be a gentle introduction to survival analysis using <code>R</code> . We’ll work through some examples to illustrate the concepts and get you going!</p>
</blockquote>
<p><span style=" font-weight: bold;    color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: #D05A6E !important;">We’ll cover:</span></p>
<ul>
<li>Some <u>basic </u> R commands</li>
<li>loading packages, <code>R</code> functions, plotting etc.</li>
<li>What is survival data?</li>
<li>Why we use survival analysis?</li>
<li>Types of survival analysis</li>
<li>Censoring in survival data</li>
<li>Comparison of survival curves (Kaplan-Meier curves, log-rank test etc.)</li>
</ul>
<p><span style=" font-weight: bold;    color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: #D05A6E !important;">Prerequisite:</span> You should be familiar with basic statistical concepts (odds ratio/risk ratio interpretation, regression) and you will feel much comfortable if you are familiar with any coding language…</p>
<p>After completing this workshop, you should be able to:</p>
<ul>
<li>Obtain descriptive statistics &amp; perform data visualisation using <code>R</code></li>
<li>Perform survival analysis and interpret parameter estimates
<ul>
<li>KM curves</li>
<li>Log-rank test</li>
</ul></li>
</ul>
<p><span style=" font-weight: bold;    color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: #D05A6E !important;">Workshop resources:</span></p>
<ul>
<li>we will be mainly using the <code>survival</code> base <code>R</code> package and the <code>survminer</code> package to perform all the analyses. The later package has some nice plotting capabilities using the <code>ggplot2</code> functionality.</li>
<li>data: most of the time we’ll be using inbuilt data sets. If not, they will be shared before the session.</li>
<li>very good readings:
<ul>
<li><a href="https://www.amazon.com/Survival-Analysis-Using-SAS-Practical/dp/1599946408/ref=dp_ob_title_bk">Allison, P. (2010), Survival Analysis Using the SAS System, Second Edition, SAS Institute.</a></li>
<li><a href="https://www.springer.com/gp/book/9780387987842">Therneau, T. M. and Grambsch, P. M. (2000), Modeling Survival Data: Extending the Cox Model, New York, USA: Springer.</a></li>
<li><a href="https://www.amazon.com/Applied-Survival-Analysis-Time-Event/dp/0471754994">D. Hosmer and S. Lemeshow (2008), Applied Survival Analysis: Regression Modeling of Time to Event Data, Wiley.</a></li>
<li><a href="https://www.springer.com/gp/book/9780387953991">Klein, J. P., and Moschberger, M. L. (2003), Survival Analysis: Techniques for Censored and Truncated Data, Springer.</a></li>
</ul></li>
</ul>
</div>
<div id="what-why-and-when" class="section level1">
<h1>What, why and when?</h1>
<div id="what-is-survival-analysis" class="section level2">
<h2>What is <strong>survival analysis</strong>?</h2>
<blockquote>
<p><span style=" font-weight: bold;    color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: #D05A6E !important;">Survival analysis</span> is the study of survival times (time until the event of interest). The response is often referred to as a <strong>survival time</strong> (e.g., time to death), <strong>event time</strong> (e.g., time to relapse) or <strong>failure time</strong>.</p>
</blockquote>
<p>Some examples of survival data in clinical setup:</p>
<ul>
<li>Time to death following a treatment (e.g., cancer treatment)</li>
<li>Time to relapse: time to recurrence of tumour/disease after a treatment</li>
<li>Time to develop a symptom: Time to return to normal blood pressure after a treatment</li>
</ul>
<p><span class="citation">[source: @KleinbaumBook]</span>(Surv.png)</p>
</div>
<div id="describing-survival-data-survival-hazard" class="section level2">
<h2>Describing survival data: survival &amp; hazard</h2>
<p>Survival function and the hazard rate (function) are two most commonly used terms that you’ll come across when working with time-to-event data.</p>
<blockquote>
<p><span style=" font-weight: bold;    color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: #D05A6E !important;">Survival probability:</span> Probability of an individual survivng beyond time <em>t</em>.</p>
</blockquote>
<blockquote>
<p><span class="math inline">\(S(t) = Pr(T &gt; t)\)</span></p>
</blockquote>
<blockquote>
<p><span style=" font-weight: bold;    color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: #D05A6E !important;">Hazard probability:</span> Rate/potential of a patient that will have the event of interest at time <em>t</em> (denoted by <em>h(t)</em>), given that the individual has survived up to time <em>t</em>.</p>
</blockquote>
<blockquote>
<p><span class="math inline">\(h(t) = \lim\limits_{\Delta t \to 0} \frac{P(t\; \leq \; T &lt; \;t \;+ \;\Delta t\;| \;T \;\geq\;t)}{\Delta t}\)</span></p>
</blockquote>
</div>
<div id="why-and-when-we-use-survival-analysis" class="section level2">
<h2>Why and when we use <strong>survival analysis</strong>?</h2>
<blockquote>
<p>Primary goals of survival analysis (<span class="citation">@KleinbaumBook</span>):</p>
</blockquote>
<ol style="list-style-type: decimal">
<li><p>To estimate and interpret survivor and/or hazard functions from survival data.</p></li>
<li><p>To compare survivor and/or hazard functions.</p></li>
<li><p>To assess the relationship of explanatory variables to survival time.</p></li>
</ol>
<p><strong>Time-to-event data (survival data) has two important features:</strong></p>
<ol style="list-style-type: decimal">
<li>Survival times are all positive (non-negative), thus we may see naturally a skewed (either right or left) data distribution.</li>
<li><strong>Censoring</strong>: Survival times of some of the study participants are not observed.
<ol style="list-style-type: lower-alpha">
<li>Event of interest did not occur before the termination of the study (study end-point)</li>
<li>Participants were lost in the follow-up</li>
<li>Participants withdraw from the study</li>
</ol></li>
</ol>
<p><strong>In survival analysis, we assume that the censoring mechanism is independent to the survival mechanism</strong></p>
<div id="censoring" class="section level3">
<h3>Censoring</h3>
<p>The three examples above for the censoring are called <strong>right-censoring</strong> (true survival time is above a certain value/ true unobserved event is to the right of the censoring time), which is quite common in majority of the clinical studies. Right censoring occurs when a study participant leaves the study before the event of interest occurs, or the study ends before the event has occurred.</p>
<p><span class="citation">[source: @KleinbaumBook]</span>(RightCens.png)</p>
<p><strong>In survival analysis, we assume that the censoring mechanism is independent to the survival mechanism</strong></p>
<p>Other types of censoring:</p>
<p>-<strong>Left-censoring</strong> (true survival time is less than or equal to the observed time): The event-of-interest occurred before the study end-point, but don’t know the exact time. For example, a study participant has the event of death before the study finishes (say at 10 months from the surgery), but the event has actually occurred before that.</p>
<p>-<strong>Interval-censoring</strong> (survival time is between two values): When we don’t know the exact time of event occurrence, but know that it is within a time interval.</p>
<p><span style=" font-weight: bold;    color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: #D05A6E !important;">Importance of censoring in analysis:</span></p>
<ul>
<li><p>Failure to account for the censoring will give you biased parameter estimates about the survival times and the related quantities.</p></li>
<li><p>Standard methods used to analyse survival data with censored observations are valid only if the censoring is <strong>noninformative</strong>. In practical terms, this means that censoring carries no prognostic information about subsequent survival experience; in other words, those who are censored because of loss to follow-up at a given point in time should be as likely to have a subsequent event as those individuals who remain in the study. <span class="citation">[@Clark2003_I]</span></p></li>
</ul>
<p>A related example on censoring:</p>
<p><a href="Cens.png">source: Clark et al, 2003</a></p>
</div>
<div id="truncation" class="section level3">
<h3>Truncation</h3>
<p>Truncation is defined as a condition which screens certain subjects so that the investigator will not be aware of their existence <span class="citation">[@KleinBook]</span>.</p>
<p>-<strong>Left truncation</strong> : In left truncation, some (or all) individuals are not followed from time zero (with respect to the study time scale), but only from later entry times.</p>
<p><span class="citation">[source: @MooreBook]</span>(LeftTrunc.png)</p>
</div>
<div id="censoring-vs-truncation" class="section level3">
<h3>Censoring vs Truncation</h3>
<blockquote>
<p>Censoring period is defined as the period the study participant is no longer under observation, but he/she <strong>may experience the event of interest</strong>.</p>
</blockquote>
<blockquote>
<p>Truncation period is defined as the period the study participant is no longer under observation, but he/she <strong>cannot experience the event of interest</strong>.</p>
</blockquote>
</div>
<div id="exercise" class="section level3">
<h3>Exercise</h3>
<ol style="list-style-type: decimal">
<li><p>Prostate cancer patients are given a drug or placebo. Survival time is the duration from remission to relapse. The study ends at 2 years with some patients yet to relapse. What type of censoring do you observe for these participants?</p>
<ul>
<li><p>Left censoring</p></li>
<li><p>Interval censoring</p></li>
<li><p>Right censoring</p></li>
<li><p>Left truncation</p></li>
</ul></li>
<li><p>We are interested in identifying prognostic factors for the survival of ovarian cancer patients. Only patients who have survived at least 5 years after diagnosis are included in the study. Type of censoring is</p>
<ul>
<li><p>Left censoring</p></li>
<li><p>Interval censoring</p></li>
<li><p>Right censoring</p></li>
<li><p>Left truncation</p></li>
</ul></li>
<li><p>For patients who start feeling better, the physicians decide to exclude them from the study</p>
<ul>
<li><p>Right truncation</p></li>
<li><p>Right censoring</p></li>
<li><p>Informative right truncation</p></li>
<li><p>Informative right censoring</p></li>
</ul></li>
</ol>
</div>
</div>
<div id="describing-survival-data-survival-hazard-1" class="section level2">
<h2>Describing survival data: survival &amp; hazard</h2>
<blockquote>
<p><span style=" font-weight: bold;    color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: #D05A6E !important;">Survival probability:</span> Probability that a patient survives from the diagnosis (time of origin) time to a specific time point <em>t</em> (denoted by <em>S(t)</em>).</p>
</blockquote>
<blockquote>
<p><span style=" font-weight: bold;    color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: #D05A6E !important;">Hazard probability:</span> Probability that a patient will have the event of interest at time <em>t</em> (denoted by <em>h(t)</em>), given that the individual has survived up to time <em>t</em>.</p>
</blockquote>
</div>
</div>
<div id="kaplan-meier-km-survival-estimate" class="section level1">
<h1>Kaplan-Meier (KM) survival estimate</h1>
<p>KM estimator (a.k.a. product limit estimator) is a non-parametric technique to estimate the survival probability from the observed survival times (Kaplan &amp; Meier, 1958). KM method could be used to obtain survival information of a single study group or between groups. Later means, for example we want to compare the survival pattern of two groups.</p>
<p>We can use <code>survival</code> package in <code>R</code> to perform the majority of the methods in survival analysis literature. A key function for the analysis of survival data in <code>R</code> is the function <code>Surv()</code>. This is used to specify the type of survival data that we want to analyse, namely, right censored, left censored, interval censored. For our illustrations, we will only consider right censored data in this workshop.</p>
<p>The <code>R</code> object created by using this function is a <strong>survival object</strong>.</p>
<blockquote>
<p>What is a <strong>survival object</strong> in <code>R</code>?</p>
</blockquote>
<p>We declare a <strong>survival object</strong> in <code>R</code> using the minimal command <code>Surv(time, event)</code>, where</p>
<ul>
<li>time: follow-up time for right-censored data</li>
<li>event: event indicator (usually dead/alive)</li>
</ul>
<div id="km-estimatecurve-single-group-study" class="section level2">
<h2>KM estimate/curve: single group study</h2>
<p><code>survfit</code> function in the <code>survival</code> package can be used to obtain KM estimate and to create survival curves. The first argument of the <code>survfit</code> function is a formula (<span class="math inline">\(Y \sim X\)</span>), where in the left-hand side we state the type of survival data using the function <code>Surv()</code> and in the right-hand side grouping information are provided.</p>
<blockquote>
<p>What do these <code>R</code> codes imply?</p>
</blockquote>
<ul>
<li><p><code>survfit(Surv(time, event) ~ 1)</code></p></li>
<li><p><code>survfit(Surv(time, event) ~ Treatment)</code></p></li>
</ul>
<p>Ok… Let’s put all these into practice now! We’ll consider two examples from ovarian cancer research. One from the study that was discussed in <span class="citation">[@Edmonson1979]</span> and the other from Bowtell’s lab <span class="citation">[@Alsop_2012]</span>. The latter study was discussed in the group comparison workshop.</p>
</div>
</div>
<div id="case-studies" class="section level1">
<h1>Case studies</h1>
<div id="study-1-ovarian-cancer-study-edmonson1979" class="section level2">
<h2>Study 1: Ovarian cancer study <span class="citation">[@Edmonson1979]</span></h2>
<p>We’ll be using the <code>ovarian</code> cancer data set provided in the <code>survival</code> package as the first example. This data set provides survival information in a randomised trial comparing two treatments for ovarian cancer <span class="citation">[@Edmonson1979]</span>. There are 6 variables in the data set. They are:</p>
<ol style="list-style-type: decimal">
<li><code>futime</code> - Follow up time (survival time)</li>
<li><code>fustat</code> - Event of interest occurred or censored</li>
<li><code>age</code> - Age of the study participants</li>
<li><code>resid.ds</code> - Residual disease status (1=no, 2=yes)</li>
<li><code>rx</code> - Treatment group (two treatments)</li>
<li><code>ecog.ps</code> - Standardised ECOG performance status (1 being good and 2 for not)</li>
</ol>
<div id="loading-required-r-packages-functions" class="section level3">
<h3>Loading required <code>R</code> packages &amp; functions</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to install&amp;load/load required R packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>install_load <span class="ot">&lt;-</span> <span class="cf">function</span> (package1, ...)  {   </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  packages <span class="ot">&lt;-</span> <span class="fu">c</span>(package1, ...)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(package <span class="cf">in</span> packages){</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(package <span class="sc">%in%</span> <span class="fu">rownames</span>(<span class="fu">installed.packages</span>()))</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">do.call</span>(<span class="st">&#39;library&#39;</span>, <span class="fu">list</span>(package))</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> {</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">install.packages</span>(package)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">do.call</span>(<span class="st">&quot;library&quot;</span>, <span class="fu">list</span>(package))</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Required R packages</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>required_R_packages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;survival&quot;</span>, <span class="st">&quot;survminer&quot;</span>, <span class="st">&quot;tidyverse&quot;</span>, <span class="st">&quot;psych&quot;</span>, </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;readxl&quot;</span>, <span class="st">&quot;kableExtra&quot;</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Install/load required R packages</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">install_load</span>(required_R_packages)</span></code></pre></div>
</div>
<div id="loading-data-from-survival-package" class="section level3">
<h3>Loading data from <code>survival</code> package</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using the survival R package </span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>ovarian_data <span class="ot">&lt;-</span> ovarian</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Structure of your data</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(ovarian_data)</span></code></pre></div>
<pre><code>&#39;data.frame&#39;:   26 obs. of  6 variables:
 $ futime  : num  59 115 156 421 431 448 464 475 477 563 ...
 $ fustat  : num  1 1 1 0 1 0 1 1 0 1 ...
 $ age     : num  72.3 74.5 66.5 53.4 50.3 ...
 $ resid.ds: num  2 2 2 2 2 1 2 2 2 1 ...
 $ rx      : num  1 1 1 2 1 1 2 2 1 2 ...
 $ ecog.ps : num  1 1 2 1 1 2 2 2 1 2 ...</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Factorisation of variables</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>ovarian_data<span class="sc">$</span>rx <span class="ot">&lt;-</span> <span class="fu">factor</span>(ovarian_data<span class="sc">$</span>rx, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>ovarian_data<span class="sc">$</span>resid.ds <span class="ot">&lt;-</span> <span class="fu">factor</span>(ovarian_data<span class="sc">$</span>resid.ds, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>), </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>ovarian_data<span class="sc">$</span>ecog.ps <span class="ot">&lt;-</span> <span class="fu">factor</span>(ovarian_data<span class="sc">$</span>ecog.ps, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>), </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>                                <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Good&quot;</span>, <span class="st">&quot;Bad&quot;</span>))</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Take a look at ovarian cancer data</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(ovarian_data)</span></code></pre></div>
<pre><code>Rows: 26
Columns: 6
$ futime   &lt;dbl&gt; 59, 115, 156, 421, 431, 448, 464, 475, 477, 563, 638, 744, 76…
$ fustat   &lt;dbl&gt; 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ age      &lt;dbl&gt; 72.3315, 74.4932, 66.4658, 53.3644, 50.3397, 56.4301, 56.9370…
$ resid.ds &lt;fct&gt; Yes, Yes, Yes, Yes, Yes, No, Yes, Yes, Yes, No, No, No, Yes, …
$ rx       &lt;fct&gt; 1, 1, 1, 2, 1, 1, 2, 2, 1, 2, 1, 2, 2, 2, 1, 1, 1, 1, 2, 2, 2…
$ ecog.ps  &lt;fct&gt; Good, Good, Bad, Good, Good, Bad, Bad, Bad, Good, Bad, Bad, G…</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to have overlayed plots</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>plot_multi_histogram <span class="ot">&lt;-</span> <span class="cf">function</span>(df, feature, label_column) {</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    plt <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text=</span>feature)), <span class="at">fill=</span><span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text=</span>label_column)))) <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">alpha=</span><span class="fl">0.7</span>, <span class="at">position=</span><span class="st">&quot;identity&quot;</span>, <span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">color=</span><span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span>feature, <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    plt <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">title=</span>label_column))</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Overlay plot of histogram and the densities </span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_multi_histogram</span>(ovarian_data, <span class="st">&#39;futime&#39;</span>, <span class="st">&#39;rx&#39;</span>)</span></code></pre></div>
<p><img src="SurvivalAnalysis_I_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Descriptive statistics</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">describeBy</span>(ovarian_data<span class="sc">$</span>futime, ovarian_data<span class="sc">$</span>rx, <span class="at">mat =</span> T)[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">13</span>, <span class="dv">14</span>)] <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> F, </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="st">&quot;left&quot;</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>                )</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; ">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
group1
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
median
</th>
<th style="text-align:right;">
min
</th>
<th style="text-align:right;">
max
</th>
<th style="text-align:right;">
range
</th>
<th style="text-align:right;">
se
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
X11
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
517.31
</td>
<td style="text-align:right;">
346.88
</td>
<td style="text-align:right;">
448
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
1106
</td>
<td style="text-align:right;">
1047
</td>
<td style="text-align:right;">
96.21
</td>
</tr>
<tr>
<td style="text-align:left;">
X12
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
681.77
</td>
<td style="text-align:right;">
324.68
</td>
<td style="text-align:right;">
563
</td>
<td style="text-align:right;">
353
</td>
<td style="text-align:right;">
1227
</td>
<td style="text-align:right;">
874
</td>
<td style="text-align:right;">
90.05
</td>
</tr>
</tbody>
</table>
</div>
<div id="km-curves" class="section level3">
<h3>KM curves</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let us convert the `Vital status` variable to a numeric variable</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>ovarian_data<span class="sc">$</span>futime <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(ovarian_data<span class="sc">$</span>futime)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># KM curve: pooling both groups</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>KM_all <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(futime, fustat) <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> ovarian_data)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>KM_all</span></code></pre></div>
<pre><code>Call: survfit(formula = Surv(futime, fustat) ~ 1, data = ovarian_data)

      n events median 0.95LCL 0.95UCL
[1,] 26     12    638     464      NA</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternatively</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">surv_median</span>(KM_all)</span></code></pre></div>
<pre><code>  strata median lower upper
1    All    638   464    NA</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtaining KM curve</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(KM_all)</span></code></pre></div>
<p><img src="SurvivalAnalysis_I_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(KM_all, <span class="at">xlab =</span> <span class="st">&quot;Futime&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Survival probability&quot;</span>, <span class="at">bty =</span><span class="st">&quot;n&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Default plotting method&quot;</span>, <span class="at">cex.main =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="SurvivalAnalysis_I_files/figure-html/unnamed-chunk-3-2.png" width="672" /></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Nicer plot with more information using survminer package</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(KM_all, </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> ovarian_data, </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">conf.int =</span> T, </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">risk.table =</span> T, </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">surv.median.line =</span> <span class="st">&quot;hv&quot;</span>, </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.title =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.labs =</span> <span class="fu">c</span>(<span class="st">&quot;All&quot;</span>), </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab=</span><span class="st">&#39;Futime&#39;</span>, </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend =</span> <span class="fu">c</span>(<span class="fl">0.6</span>,<span class="fl">0.8</span>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>           ) </span></code></pre></div>
<p><img src="SurvivalAnalysis_I_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the hazard function</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(KM_all, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">conf.int =</span> <span class="cn">TRUE</span>, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">risk.table =</span> <span class="cn">TRUE</span>, </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">fun =</span> <span class="st">&quot;cumhaz&quot;</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>           )</span></code></pre></div>
<p><img src="SurvivalAnalysis_I_files/figure-html/unnamed-chunk-4-2.png" width="672" /></p>
</div>
<div id="km-curves-for-both-groups" class="section level3">
<h3>KM curves for both groups</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># KM curves for both groups</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>KM_groups <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(futime, fustat) <span class="sc">~</span> rx, <span class="at">data =</span> ovarian_data)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>KM_groups</span></code></pre></div>
<pre><code>Call: survfit(formula = Surv(futime, fustat) ~ rx, data = ovarian_data)

      n events median 0.95LCL 0.95UCL
rx=1 13      7    638     268      NA
rx=2 13      5     NA     475      NA</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtaining KM curve</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(KM_groups, <span class="at">xlab =</span> <span class="st">&quot;OSDx (months)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Survival probability&quot;</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Default plotting method&quot;</span>, <span class="at">cex.main =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="SurvivalAnalysis_I_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Nicer plot with more information using survminer package</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(KM_groups, </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> ovarian_data, </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">conf.int =</span> T, </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">risk.table =</span> T,  </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">surv.median.line =</span> <span class="st">&quot;hv&quot;</span>, </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.title =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.labs =</span> <span class="fu">c</span>(<span class="st">&quot;Treatment 1&quot;</span>, <span class="st">&quot;Treatment 2&quot;</span>), </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab=</span><span class="st">&#39;Futime&#39;</span>, </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend =</span> <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.2</span>)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>           ) </span></code></pre></div>
<p><img src="SurvivalAnalysis_I_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the hazard functions</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(KM_groups, </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">conf.int =</span> <span class="cn">TRUE</span>, </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">risk.table =</span> <span class="cn">TRUE</span>, </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">fun =</span> <span class="st">&quot;cumhaz&quot;</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>           )</span></code></pre></div>
<p><img src="SurvivalAnalysis_I_files/figure-html/unnamed-chunk-6-2.png" width="672" /></p>
</div>
</div>
<div id="study-2-ovarian-cancer-study-alsop_2012" class="section level2">
<h2>Study 2: Ovarian cancer study <span class="citation">[@Alsop_2012]</span></h2>
<p>We’ll consider the overall survival information in this study.</p>
<div id="loading-data" class="section level3">
<h3>Loading data</h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>JCO_orig <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;data/data_kathryn.xlsx&quot;</span>, <span class="at">sheet =</span> <span class="dv">1</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Get a glimpse of your data</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(JCO_orig)</span></code></pre></div>
<pre><code>Rows: 1,001
Columns: 21
$ `Deidentified StudyID`   &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14…
$ AgeAtDiag                &lt;dbl&gt; 68.14521, 54.19178, 79.96986, 53.96438, 70.50…
$ `Age Group`              &lt;dbl&gt; 4, 3, 4, 3, 4, 1, 2, 4, 3, 2, 4, 4, 4, 4, 4, …
$ Status                   &lt;chr&gt; &quot;D&quot;, &quot;D&quot;, &quot;PF&quot;, &quot;D&quot;, &quot;D&quot;, &quot;P&quot;, &quot;D&quot;, &quot;D&quot;, &quot;PF&quot;…
$ PFSDx                    &lt;dbl&gt; 18.8381497, 16.0765361, 68.3499359, 10.356050…
$ OSDx                     &lt;dbl&gt; 52.2733997, 35.0461913, 68.3499359, 39.024229…
$ `Primary Site`           &lt;chr&gt; &quot;Ovary&quot;, &quot;Peritoneum&quot;, &quot;Fallopian&quot;, &quot;Ovary&quot;, …
$ Subtype                  &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 2, …
$ Description              &lt;chr&gt; &quot;Papillary serous adenocarcinoma (C56.9)&quot;, &quot;P…
$ `Grade+Differentiation`  &lt;chr&gt; &quot;3&quot;, &quot;3&quot;, &quot;3&quot;, &quot;9&quot;, &quot;3&quot;, &quot;1&quot;, &quot;3&quot;, &quot;3&quot;, &quot;2&quot;, …
$ StageGrp                 &lt;chr&gt; &quot;IV&quot;, &quot;IV&quot;, &quot;IV&quot;, &quot;III&quot;, &quot;III&quot;, &quot;III&quot;, &quot;III&quot;,…
$ race                     &lt;dbl&gt; 1, 1, 1, 5, 5, 1, 1, 1, 1, 5, 1, 1, 5, 5, 1, …
$ PrimaryPlt               &lt;dbl&gt; 6, 6, 6, 6, NA, 6, 8, 6, 4, 8, 6, 6, 7, 1, 6,…
$ CauseDeath               &lt;chr&gt; &quot;1&quot;, &quot;1&quot;, NA, &quot;1&quot;, &quot;2&quot;, NA, &quot;1&quot;, &quot;1&quot;, NA, NA,…
$ PrimaryTaxane            &lt;dbl&gt; NA, 6, NA, 6, NA, 6, 8, 6, NA, 8, 4, 5, 4, 4,…
$ OptimalDebulking         &lt;dbl&gt; 2, 3, 1, 2, 2, 1, 3, 1, 1, 1, 1, 1, 1, 3, 2, …
$ Time                     &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ PF                       &lt;dbl&gt; 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 1, 2, 0, 0, …
$ PFReason                 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, &quot;…
$ Mcancer                  &lt;dbl&gt; 0, 0, 0, 0, 4, 0, 0, 0, 5, 4, 0, 5, 5, 5, 0, …
$ `Gene mutation found in` &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(JCO_orig)</span></code></pre></div>
<pre><code>tibble [1,001 × 21] (S3: tbl_df/tbl/data.frame)
 $ Deidentified StudyID  : num [1:1001] 1 2 3 4 5 6 7 8 9 10 ...
 $ AgeAtDiag             : num [1:1001] 68.1 54.2 80 54 70.5 ...
 $ Age Group             : num [1:1001] 4 3 4 3 4 1 2 4 3 2 ...
 $ Status                : chr [1:1001] &quot;D&quot; &quot;D&quot; &quot;PF&quot; &quot;D&quot; ...
 $ PFSDx                 : num [1:1001] 18.838 16.077 68.35 10.356 0.756 ...
 $ OSDx                  : num [1:1001] 52.273 35.046 68.35 39.024 0.756 ...
 $ Primary Site          : chr [1:1001] &quot;Ovary&quot; &quot;Peritoneum&quot; &quot;Fallopian&quot; &quot;Ovary&quot; ...
 $ Subtype               : num [1:1001] 1 1 1 1 1 1 1 1 3 1 ...
 $ Description           : chr [1:1001] &quot;Papillary serous adenocarcinoma (C56.9)&quot; &quot;Papillary serous adenocarcinoma (C56.9)&quot; &quot;Papillary serous cystadenocarcinoma (C56.9)&quot; &quot;Papillary serous cystadenocarcinoma (C56.9)&quot; ...
 $ Grade+Differentiation : chr [1:1001] &quot;3&quot; &quot;3&quot; &quot;3&quot; &quot;9&quot; ...
 $ StageGrp              : chr [1:1001] &quot;IV&quot; &quot;IV&quot; &quot;IV&quot; &quot;III&quot; ...
 $ race                  : num [1:1001] 1 1 1 5 5 1 1 1 1 5 ...
 $ PrimaryPlt            : num [1:1001] 6 6 6 6 NA 6 8 6 4 8 ...
 $ CauseDeath            : chr [1:1001] &quot;1&quot; &quot;1&quot; NA &quot;1&quot; ...
 $ PrimaryTaxane         : num [1:1001] NA 6 NA 6 NA 6 8 6 NA 8 ...
 $ OptimalDebulking      : num [1:1001] 2 3 1 2 2 1 3 1 1 1 ...
 $ Time                  : chr [1:1001] NA NA NA NA ...
 $ PF                    : num [1:1001] 0 0 0 0 2 0 0 0 0 0 ...
 $ PFReason              : chr [1:1001] NA NA NA NA ...
 $ Mcancer               : num [1:1001] 0 0 0 0 4 0 0 0 5 4 ...
 $ Gene mutation found in: chr [1:1001] NA NA NA NA ...</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Replacing NAs with &quot;Negative&quot;</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>JCO_data <span class="ot">&lt;-</span> JCO_orig <span class="sc">%&gt;%</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="st">`</span><span class="at">Gene mutation found in</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot;Negative&quot;</span>))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Factoring &quot;Gene mutation found in&quot; column</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>JCO_data<span class="sc">$</span><span class="st">`</span><span class="at">Gene mutation found in</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">factor</span>(JCO_data<span class="sc">$</span><span class="st">`</span><span class="at">Gene mutation found in</span><span class="st">`</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Replacing BRCA1 and BRCA2 as combined positive</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>JCO_data <span class="ot">&lt;-</span> JCO_data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Gene mutation found in</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">recode</span>(<span class="st">`</span><span class="at">Gene mutation found in</span><span class="st">`</span>, <span class="st">&quot;BRCA1&quot;</span><span class="ot">=</span><span class="st">&quot;Combined_positive&quot;</span>, <span class="st">&quot;BRCA2&quot;</span><span class="ot">=</span><span class="st">&quot;Combined_positive&quot;</span>))</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Changing the column name</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(JCO_data)[<span class="dv">21</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Mutation_status&quot;</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtering only combined positive and negative observations &amp; only overall survival</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>JCO_final <span class="ot">&lt;-</span> JCO_data <span class="sc">%&gt;%</span> </span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(Mutation_status <span class="sc">!=</span> <span class="fu">c</span>(<span class="st">&quot;UV&quot;</span>), </span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>                       Status <span class="sc">!=</span> <span class="fu">c</span>(<span class="st">&quot;PF&quot;</span>))</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Replacing D and P to 1 (dead) and 0 (alive)</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>JCO_final <span class="ot">&lt;-</span> JCO_final <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Status =</span> <span class="fu">recode</span>(Status, <span class="st">&quot;D&quot;</span><span class="ot">=</span><span class="dv">1</span>, <span class="st">&quot;P&quot;</span><span class="ot">=</span><span class="dv">0</span>))</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting final data set</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>JCO_final<span class="sc">$</span>Mutation_status <span class="ot">&lt;-</span> <span class="fu">factor</span>(JCO_final<span class="sc">$</span>Mutation_status)</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>JCO_final<span class="sc">$</span>Status <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(JCO_final<span class="sc">$</span>Status) </span></code></pre></div>
</div>
<div id="km-curves-for-both-groups-1" class="section level3">
<h3>KM curves for both groups</h3>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># KM curves for both groups</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>KM_groups_Alsop <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(OSDx, Status) <span class="sc">~</span> Mutation_status, <span class="at">data =</span> JCO_final)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>KM_groups_Alsop</span></code></pre></div>
<pre><code>Call: survfit(formula = Surv(OSDx, Status) ~ Mutation_status, data = JCO_final)

                                    n events median 0.95LCL 0.95UCL
Mutation_status=Combined_positive 106     76   47.9    43.3    55.2
Mutation_status=Negative          566    456   32.0    29.2    35.7</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(JCO_final<span class="sc">$</span>Status)</span></code></pre></div>
<pre><code>
  0   1 
140 532 </code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtaining KM curve</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(KM_groups_Alsop, </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> JCO_final, </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">conf.int =</span> T, </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">risk.table =</span> T,  </span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">surv.median.line =</span> <span class="st">&quot;hv&quot;</span>, </span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.title =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.labs =</span> <span class="fu">c</span>(<span class="st">&quot;Positive&quot;</span>, <span class="st">&quot;Negative&quot;</span>), </span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab=</span><span class="st">&#39;Futime&#39;</span>, </span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend =</span> <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.2</span>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>           ) </span></code></pre></div>
<p><img src="SurvivalAnalysis_I_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>So, now we know how to obtain KM curves using <code>R</code>. Next obvious question is,</p>
<blockquote>
<p>How can we test the observed difference in survival is statistically significant or not?</p>
</blockquote>
<p>For this purpose, we could use the well established log-rank test. It is a simple test to answer the above question. What is log-rank test?</p>
</div>
</div>
</div>
<div id="log-rank-test" class="section level1">
<h1>Log-rank test</h1>
<p>Log-rank (Mantel-Haenszel) test is a non-parametric method for testing the hypothesis:</p>
<p><span class="math inline">\(H_0 : distribution \; of \; survival \; times \; is \; the \; same \; for \; the \; groups\)</span></p>
<p><span class="math inline">\(H_1 : it \; is \; not\; the \; same\)</span></p>
<p>This is a large-sample chi-square test and it provides an overall comparison of the KM curves being compared. The testing null hypothesis is that there is no overall difference between the two survival curves. Under this null hypothesis, the log–rank statistic is distributed approximately chi-square with one degree of freedom.</p>
<p><strong>Note:</strong> 1. Test is only valid if the ratio between two hazards of the groups is a constant! (proportional hazards assumption)</p>
<ol start="2" style="list-style-type: decimal">
<li>It places the same weight on all follow-up times</li>
</ol>
<p>The <code>survival</code> package provides the function <code>survdiff</code> to perform log-rank tests for differences between survival curves. Syntax for this function is pretty similar to the <code>survfit</code> function that we used earlier.</p>
<div id="case-study-1" class="section level2">
<h2>Case study 1</h2>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">survdiff</span>(<span class="fu">Surv</span>(futime, fustat) <span class="sc">~</span> rx, <span class="at">data =</span> ovarian_data)</span></code></pre></div>
<pre><code>Call:
survdiff(formula = Surv(futime, fustat) ~ rx, data = ovarian_data)

      N Observed Expected (O-E)^2/E (O-E)^2/V
rx=1 13        7     5.23     0.596      1.06
rx=2 13        5     6.77     0.461      1.06

 Chisq= 1.1  on 1 degrees of freedom, p= 0.3 </code></pre>
<p>We obtain a non-significant difference in the survival curves between the two treatment groups.</p>
</div>
<div id="case-study-2" class="section level2">
<h2>Case study 2</h2>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">survdiff</span>(<span class="fu">Surv</span>(OSDx, Status) <span class="sc">~</span> Mutation_status, <span class="at">data =</span> JCO_final)</span></code></pre></div>
<pre><code>Call:
survdiff(formula = Surv(OSDx, Status) ~ Mutation_status, data = JCO_final)

                                    N Observed Expected (O-E)^2/E (O-E)^2/V
Mutation_status=Combined_positive 106       76      110     10.74      13.6
Mutation_status=Negative          566      456      422      2.81      13.6

 Chisq= 13.6  on 1 degrees of freedom, p= 2e-04 </code></pre>
<p>We obtain a highly significant difference in the survival curves between BRCA1/2 positive and negative groups.</p>
</div>
</div>
<div id="weighted-log-rank-tests" class="section level1">
<h1>Weighted Log-rank tests</h1>
<p>Weighted Log-rank tests are useful when the standard assumptions of the general Log-rank test are violated.</p>
<div id="peto-and-peto-modified-gehan-wilcoxon-test" class="section level2">
<h2>Peto and Peto modified Gehan-Wilcoxon test</h2>
<p>This is a version of Log-rank test that sits broadly under the G-rho family of Harrington and Fleming tests (<span class="citation">[@Harrington1982]</span>). It is a good alternative to consider when:</p>
<ul>
<li><p>hazard functions are not proportional</p></li>
<li><p>better when you have more event times earlier</p></li>
</ul>
<p>The Peto &amp; Peto modified Gehan-Wilcoxon test is again computed using function <code>survdiff()</code>; however, we need to set argument <code>rho</code> to 1.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">survdiff</span>(<span class="fu">Surv</span>(futime, fustat) <span class="sc">~</span> rx, <span class="at">rho =</span> <span class="dv">1</span>, <span class="at">data =</span> ovarian_data)</span></code></pre></div>
<pre><code>Call:
survdiff(formula = Surv(futime, fustat) ~ rx, data = ovarian_data, 
    rho = 1)

      N Observed Expected (O-E)^2/E (O-E)^2/V
rx=1 13     5.89     4.12     0.761      1.68
rx=2 13     3.50     5.27     0.595      1.68

 Chisq= 1.7  on 1 degrees of freedom, p= 0.2 </code></pre>
<p>Similar conclusion as earlier.</p>
<blockquote>
<p>Which of the 2 tests should be preferred?</p>
</blockquote>
<ul>
<li><p>if survival curves cross, both tests are not optimal</p></li>
<li><p>check if the proportional hazard assumption is seriously violated (hint: use proportional hazards plot)</p>
<ul>
<li><p>Log-rank test is the most powerful test when proportionality assumption is valid</p></li>
<li><p>otherwise use the weighted method</p></li>
</ul></li>
</ul>
</div>
</div>
<div id="stratified-log-rank-test" class="section level1">
<h1>Stratified log-rank test</h1>
<p>Stratified log-rank test is an extension of the log-rank test to incorporate controlling variable(s) to test the effective difference between survival curves of the variable of interest. For example, let us assume that we have two treatment groups (A &amp; B) and we want to control for gender (male &amp; female). We may use stratified log-rank test in this case to assess the significance of the survival curves of the two treatment groups controlling for the variable gender. Thus, it provides a method of testing the equivalence of survival curves controlling for the stratified variable <span class="citation">[@KleinBook]</span>.</p>
<div id="performing-stratified-log-rank-test" class="section level2">
<h2>Performing stratified log-rank test</h2>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtaining survival curves</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>KM_strata <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(OSDx, Status) <span class="sc">~</span> Mutation_status <span class="sc">+</span> <span class="fu">strata</span>(Subtype), <span class="at">data =</span> JCO_final)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co">#KM_strata</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting KM survival curves</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(KM_strata, <span class="at">data =</span> JCO_final)</span></code></pre></div>
<p><img src="SurvivalAnalysis_I_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Stratified log-rank test</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">survdiff</span>(<span class="fu">Surv</span>(OSDx, Status) <span class="sc">~</span> Mutation_status <span class="sc">+</span> <span class="fu">strata</span>(Subtype), <span class="at">data =</span> JCO_final)</span></code></pre></div>
<pre><code>Call:
survdiff(formula = Surv(OSDx, Status) ~ Mutation_status + strata(Subtype), 
    data = JCO_final)

                                    N Observed Expected (O-E)^2/E (O-E)^2/V
Mutation_status=Combined_positive 106       76      107      8.80      11.4
Mutation_status=Negative          566      456      425      2.21      11.4

 Chisq= 11.4  on 1 degrees of freedom, p= 7e-04 </code></pre>
<p>The test results indicate that even after adjusting for the possible confounding variable Subtype, there is a statistically significant difference between the survival curves of the two groups.</p>
</div>
</div>
<div id="exercise-1" class="section level1">
<h1>Exercise</h1>
<p>Consider the variable <code>resid.ds</code> (residual disease) in the <code>ovarian</code> data set (case study 1) when answering the following questions.</p>
<ol style="list-style-type: decimal">
<li>Draw KM curves. Comment on the survival patterns of the two groups (residual disease Yes vs. No).</li>
<li>Is there a significant difference between the survival curves?<br />
</li>
<li>Perform a stratified log-rank test to assess the survivor relationship between <code>resid.ds</code> and survival times controlling for the variable <code>agegrp</code>. Comment on the results.</li>
</ol>
<p><br /></p>
<details>
<summary>
<strong>Session Information</strong>
</summary>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 4.1.2 (2021-11-01)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 20.04.3 LTS
## 
## Matrix products: default
## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0
## 
## locale:
##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] readxl_1.3.1     psych_2.1.9      forcats_0.5.1    stringr_1.4.0   
##  [5] dplyr_1.0.7      purrr_0.3.4      readr_2.1.2      tidyr_1.2.0     
##  [9] tibble_3.1.6     tidyverse_1.3.1  survminer_0.4.9  ggpubr_0.4.0    
## [13] ggplot2_3.3.5    survival_3.2-13  kableExtra_1.3.4
## 
## loaded via a namespace (and not attached):
##  [1] httr_1.4.2        jsonlite_1.7.3    viridisLite_0.4.0 splines_4.1.2    
##  [5] tmvnsim_1.0-2     carData_3.0-5     modelr_0.1.8      assertthat_0.2.1 
##  [9] highr_0.9         cellranger_1.1.0  yaml_2.2.2        pillar_1.7.0     
## [13] backports_1.4.1   lattice_0.20-45   glue_1.6.1        digest_0.6.29    
## [17] gridtext_0.1.4    ggsignif_0.6.3    rvest_1.0.2       colorspace_2.0-2 
## [21] htmltools_0.5.2   Matrix_1.3-4      pkgconfig_2.0.3   broom_0.7.12     
## [25] haven_2.4.3       xtable_1.8-4      scales_1.1.1      webshot_0.5.2    
## [29] svglite_2.1.0     km.ci_0.5-2       KMsurv_0.1-5      tzdb_0.2.0       
## [33] farver_2.1.0      generics_0.1.2    car_3.0-12        ellipsis_0.3.2   
## [37] withr_2.4.3       mnormt_2.0.2      cli_3.1.1         magrittr_2.0.2   
## [41] crayon_1.4.2      ggtext_0.1.1      evaluate_0.14     fs_1.5.2         
## [45] fansi_1.0.2       nlme_3.1-153      rstatix_0.7.0     xml2_1.3.3       
## [49] tools_4.1.2       data.table_1.14.2 hms_1.1.1         lifecycle_1.0.1  
## [53] munsell_0.5.0     reprex_2.0.1      compiler_4.1.2    jquerylib_0.1.4  
## [57] systemfonts_1.0.3 rlang_1.0.1       grid_4.1.2        rstudioapi_0.13  
## [61] labeling_0.4.2    rmarkdown_2.11    gtable_0.3.0      abind_1.4-5      
## [65] DBI_1.1.2         markdown_1.1      R6_2.5.1          gridExtra_2.3    
## [69] zoo_1.8-9         lubridate_1.8.0   knitr_1.37        fastmap_1.1.0    
## [73] survMisc_0.5.5    utf8_1.2.2        stringi_1.7.6     parallel_4.1.2   
## [77] Rcpp_1.0.8        vctrs_0.3.8       dbplyr_2.1.1      tidyselect_1.1.1 
## [81] xfun_0.29</code></pre>
</details>
<p><br /></p>
</div>
<div id="references" class="section level1">
<h1>References</h1>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiU3Vydml2YWwgQW5hbHlzaXMgVXNpbmcgUiAtIFBhcnQgSSIKYXV0aG9yOiAiTWFkYXdhIEpheWF3YXJkYW5hIgpkYXRlOiAnJwpvdXRwdXQ6CiAgaHRtbF9kb2N1bWVudDoKICAgIGhpZ2hsaWdodDogdGFuZ28KICAgIHRvYzogeWVzCiAgICB0b2NfZmxvYXQ6CiAgICAgIGNvbGxhcHNlZDogeWVzCiAgICBjb2RlX2Rvd25sb2FkOiB0cnVlCiAgICBjc3M6ICJzdHlsZS5jc3MiCmFsd2F5c19hbGxvd19odG1sOiB0cnVlCnN1YnRpdGxlOiBXaGF0IGlzIHN1cnZpdmFsIGFuYWx5c2lzPyBLTSBjdXJ2ZXMgYW5kIGxvZy1yYW5rIHRlc3RzCiNiaWJsaW9ncmFwaHk6IGJpYmxpb1N1cnZpdmFsLmJpYgotLS0KCmBgYHtyIHNldHVwLCBpbmNsdWRlPUZBTFNFfQpsaWJyYXJ5KGthYmxlRXh0cmEpCiNvcHRpb25zKGtuaXRyLnRhYmxlLmZvcm1hdCA9ICJodG1sIikKb3B0aW9ucyhrYWJsZUV4dHJhLmF1dG9fZm9ybWF0ID0gRkFMU0UpCgprbml0cjo6a25pdF9ob29rcyRzZXQoCiAgIGVycm9yID0gZnVuY3Rpb24oeCwgb3B0aW9ucykgewogICAgIHBhc3RlKCdcblxuPGRpdiBjbGFzcz0iYWxlcnQgYWxlcnQtZGFuZ2VyIj4nLAogICAgICAgICAgIGdzdWIoJyMjJywgJ1xuJywgZ3N1YignXiMjXCBFcnJvcicsICcqKkVycm9yKionLCB4KSksCiAgICAgICAgICAgJzwvZGl2PicsIHNlcCA9ICdcbicpCiAgIH0sCiAgIHdhcm5pbmcgPSBmdW5jdGlvbih4LCBvcHRpb25zKSB7CiAgICAgcGFzdGUoJ1xuXG48ZGl2IGNsYXNzPSJhbGVydCBhbGVydC13YXJuaW5nIj4nLAogICAgICAgICAgIGdzdWIoJyMjJywgJ1xuJywgZ3N1YignXiMjXCBXYXJuaW5nOicsICcqKldhcm5pbmcqKicsIHgpKSwKICAgICAgICAgICAnPC9kaXY+Jywgc2VwID0gJ1xuJykKICAgfSwKICAgbWVzc2FnZSA9IGZ1bmN0aW9uKHgsIG9wdGlvbnMpIHsKICAgICBwYXN0ZSgnXG5cbjxkaXYgY2xhc3M9ImFsZXJ0IGFsZXJ0LWluZm8iPicsCiAgICAgICAgICAgZ3N1YignIyMnLCAnXG4nLCB4KSwKICAgICAgICAgICAnPC9kaXY+Jywgc2VwID0gJ1xuJykKICAgfQopCiNgciB0ZXh0X3NwZWMoIlRFWFQiLCBiYWNrZ3JvdW5kID0gIiNEMDVBNkUiLCBjb2xvciA9ICJ3aGl0ZSIsIGJvbGQgPSBUKWAKYGBgCgojIEludHJvZHVjdGlvbiAKCj5XZWxjb21lISBUaGlzIGlzIHRoZSBwYXJ0IEkgb2YgdGhlIHdvcmtzaG9wIHNlcmllcyBvbiBzdXJ2aXZhbCBhbmFseXNpcy4gVGhpcyB3aWxsIGJlIGEgZ2VudGxlIGludHJvZHVjdGlvbiB0byBzdXJ2aXZhbCBhbmFseXNpcyB1c2luZyBgUmAgLiBXZSdsbCB3b3JrIHRocm91Z2ggc29tZSBleGFtcGxlcyB0byBpbGx1c3RyYXRlIHRoZSBjb25jZXB0cyBhbmQgZ2V0IHlvdSBnb2luZyEgCgpgciB0ZXh0X3NwZWMoIldlJ2xsIGNvdmVyOiIsIGJhY2tncm91bmQgPSAiI0QwNUE2RSIsIGNvbG9yID0gIndoaXRlIiwgYm9sZCA9IFQpYAoKLSBTb21lIDx1PmJhc2ljIDwvdT4gUiBjb21tYW5kcwotIGxvYWRpbmcgcGFja2FnZXMsIGBSYCBmdW5jdGlvbnMsIHBsb3R0aW5nIGV0Yy4KLSBXaGF0IGlzIHN1cnZpdmFsIGRhdGE/Ci0gV2h5IHdlIHVzZSBzdXJ2aXZhbCBhbmFseXNpcz8KLSBUeXBlcyBvZiBzdXJ2aXZhbCBhbmFseXNpcwotIENlbnNvcmluZyBpbiBzdXJ2aXZhbCBkYXRhCi0gQ29tcGFyaXNvbiBvZiBzdXJ2aXZhbCBjdXJ2ZXMgKEthcGxhbi1NZWllciBjdXJ2ZXMsIGxvZy1yYW5rIHRlc3QgZXRjLikKCmByIHRleHRfc3BlYygiUHJlcmVxdWlzaXRlOiIsIGJhY2tncm91bmQgPSAiI0QwNUE2RSIsIGNvbG9yID0gIndoaXRlIiwgYm9sZCA9IFQpYCBZb3Ugc2hvdWxkIGJlIGZhbWlsaWFyIHdpdGggYmFzaWMgc3RhdGlzdGljYWwgY29uY2VwdHMgKG9kZHMgcmF0aW8vcmlzayByYXRpbyBpbnRlcnByZXRhdGlvbiwgcmVncmVzc2lvbikgYW5kIHlvdSB3aWxsIGZlZWwgbXVjaCBjb21mb3J0YWJsZSBpZiB5b3UgYXJlIGZhbWlsaWFyIHdpdGggYW55IGNvZGluZyBsYW5ndWFnZS4uLgoKQWZ0ZXIgY29tcGxldGluZyB0aGlzIHdvcmtzaG9wLCB5b3Ugc2hvdWxkIGJlIGFibGUgdG86CgotIE9idGFpbiBkZXNjcmlwdGl2ZSBzdGF0aXN0aWNzICYgcGVyZm9ybSBkYXRhIHZpc3VhbGlzYXRpb24gdXNpbmcgYFJgCi0gUGVyZm9ybSBzdXJ2aXZhbCBhbmFseXNpcyBhbmQgaW50ZXJwcmV0IHBhcmFtZXRlciBlc3RpbWF0ZXMKICAtIEtNIGN1cnZlcwogIC0gTG9nLXJhbmsgdGVzdAoKYHIgdGV4dF9zcGVjKCJXb3Jrc2hvcCByZXNvdXJjZXM6IiwgYmFja2dyb3VuZCA9ICIjRDA1QTZFIiwgY29sb3IgPSAid2hpdGUiLCBib2xkID0gVClgCgotIHdlIHdpbGwgYmUgbWFpbmx5IHVzaW5nIHRoZSBgc3Vydml2YWxgIGJhc2UgYFJgIHBhY2thZ2UgYW5kIHRoZSBgc3Vydm1pbmVyYCBwYWNrYWdlIHRvIHBlcmZvcm0KYWxsIHRoZSBhbmFseXNlcy4gVGhlIGxhdGVyIHBhY2thZ2UgaGFzIHNvbWUgbmljZSBwbG90dGluZyBjYXBhYmlsaXRpZXMgdXNpbmcgdGhlIGBnZ3Bsb3QyYApmdW5jdGlvbmFsaXR5LiAKLSBkYXRhOiBtb3N0IG9mIHRoZSB0aW1lIHdlJ2xsIGJlIHVzaW5nIGluYnVpbHQgZGF0YSBzZXRzLiBJZiBub3QsIHRoZXkgd2lsbCBiZSBzaGFyZWQgYmVmb3JlIHRoZSBzZXNzaW9uLgotIHZlcnkgZ29vZCByZWFkaW5nczoKICAtIFtBbGxpc29uLCBQLiAoMjAxMCksIFN1cnZpdmFsIEFuYWx5c2lzIFVzaW5nIHRoZSBTQVMgU3lzdGVtLCBTZWNvbmQgRWRpdGlvbiwgU0FTIEluc3RpdHV0ZS5dKGh0dHBzOi8vd3d3LmFtYXpvbi5jb20vU3Vydml2YWwtQW5hbHlzaXMtVXNpbmctU0FTLVByYWN0aWNhbC9kcC8xNTk5OTQ2NDA4L3JlZj1kcF9vYl90aXRsZV9iaykKICAtIFtUaGVybmVhdSwgVC4gTS4gYW5kIEdyYW1ic2NoLCBQLiBNLiAoMjAwMCksIE1vZGVsaW5nIFN1cnZpdmFsIERhdGE6IEV4dGVuZGluZyB0aGUgQ294IE1vZGVsLCBOZXcgWW9yaywgVVNBOiBTcHJpbmdlci5dKGh0dHBzOi8vd3d3LnNwcmluZ2VyLmNvbS9ncC9ib29rLzk3ODAzODc5ODc4NDIpCiAgLSBbRC4gSG9zbWVyIGFuZCBTLiBMZW1lc2hvdyAoMjAwOCksIEFwcGxpZWQgU3Vydml2YWwgQW5hbHlzaXM6IFJlZ3Jlc3Npb24gTW9kZWxpbmcgb2YgVGltZSB0byBFdmVudApEYXRhLCBXaWxleS5dKGh0dHBzOi8vd3d3LmFtYXpvbi5jb20vQXBwbGllZC1TdXJ2aXZhbC1BbmFseXNpcy1UaW1lLUV2ZW50L2RwLzA0NzE3NTQ5OTQpCiAgLSBbS2xlaW4sIEouIFAuLCBhbmQgTW9zY2hiZXJnZXIsIE0uIEwuICgyMDAzKSwgU3Vydml2YWwgQW5hbHlzaXM6IFRlY2huaXF1ZXMgZm9yIENlbnNvcmVkIGFuZCBUcnVuY2F0ZWQgRGF0YSwgU3ByaW5nZXIuXShodHRwczovL3d3dy5zcHJpbmdlci5jb20vZ3AvYm9vay85NzgwMzg3OTUzOTkxKQoKCiMgV2hhdCwgd2h5IGFuZCB3aGVuPwoKIyMgV2hhdCBpcyAqKnN1cnZpdmFsIGFuYWx5c2lzKio/Cgo+IGByIHRleHRfc3BlYygiU3Vydml2YWwgYW5hbHlzaXMiLCBiYWNrZ3JvdW5kID0gIiNEMDVBNkUiLCBjb2xvciA9ICJ3aGl0ZSIsIGJvbGQgPSBUKWAgaXMgdGhlIHN0dWR5IG9mIHN1cnZpdmFsIHRpbWVzICh0aW1lIHVudGlsIHRoZSBldmVudCBvZiBpbnRlcmVzdCkuIFRoZSByZXNwb25zZSBpcyBvZnRlbiByZWZlcnJlZCB0byBhcyBhICAqKnN1cnZpdmFsIHRpbWUqKiAoZS5nLiwgdGltZSB0byBkZWF0aCksICoqZXZlbnQgdGltZSoqIChlLmcuLCB0aW1lIHRvIHJlbGFwc2UpIG9yICoqZmFpbHVyZSB0aW1lKiouCgpTb21lIGV4YW1wbGVzIG9mIHN1cnZpdmFsIGRhdGEgaW4gY2xpbmljYWwgc2V0dXA6CgotIFRpbWUgdG8gZGVhdGggZm9sbG93aW5nIGEgdHJlYXRtZW50IChlLmcuLCBjYW5jZXIgdHJlYXRtZW50KQotIFRpbWUgdG8gcmVsYXBzZTogdGltZSB0byByZWN1cnJlbmNlIG9mIHR1bW91ci9kaXNlYXNlIGFmdGVyIGEgdHJlYXRtZW50Ci0gVGltZSB0byBkZXZlbG9wIGEgc3ltcHRvbTogVGltZSB0byByZXR1cm4gdG8gbm9ybWFsIGJsb29kIHByZXNzdXJlIGFmdGVyIGEgdHJlYXRtZW50Cgpbc291cmNlOiBAS2xlaW5iYXVtQm9va10oU3Vydi5wbmcpCgojIyBEZXNjcmliaW5nIHN1cnZpdmFsIGRhdGE6IHN1cnZpdmFsICYgaGF6YXJkCgpTdXJ2aXZhbCBmdW5jdGlvbiBhbmQgdGhlIGhhemFyZCByYXRlIChmdW5jdGlvbikgYXJlIHR3byBtb3N0IGNvbW1vbmx5IHVzZWQgdGVybXMgdGhhdCB5b3UnbGwgY29tZSBhY3Jvc3Mgd2hlbiB3b3JraW5nIHdpdGggdGltZS10by1ldmVudCBkYXRhLgoKPmByIHRleHRfc3BlYygiU3Vydml2YWwgcHJvYmFiaWxpdHk6IiwgYmFja2dyb3VuZCA9ICIjRDA1QTZFIiwgY29sb3IgPSAid2hpdGUiLCBib2xkID0gVClgIFByb2JhYmlsaXR5IG9mIGFuIGluZGl2aWR1YWwgc3Vydml2bmcgYmV5b25kIHRpbWUgKnQqLiAKCj4gJFModCkgPSBQcihUID4gdCkkCiAgIAogICAKPmByIHRleHRfc3BlYygiSGF6YXJkIHByb2JhYmlsaXR5OiIsIGJhY2tncm91bmQgPSAiI0QwNUE2RSIsIGNvbG9yID0gIndoaXRlIiwgYm9sZCA9IFQpYCBSYXRlL3BvdGVudGlhbCBvZiBhIHBhdGllbnQgdGhhdCB3aWxsIGhhdmUgdGhlIGV2ZW50IG9mIGludGVyZXN0IGF0IHRpbWUgKnQqIChkZW5vdGVkIGJ5ICpoKHQpKiksIGdpdmVuIHRoYXQgdGhlIGluZGl2aWR1YWwgaGFzIHN1cnZpdmVkIHVwIHRvIHRpbWUgKnQqLgoKPiAkaCh0KSA9IFxsaW1cbGltaXRzX3tcRGVsdGEgdCBcdG8gMH0gXGZyYWN7UCh0XDsgXGxlcSBcOyBUIDwgXDt0IFw7KyBcO1xEZWx0YSB0XDt8IFw7VCBcO1xnZXFcO3QpfXtcRGVsdGEgdH0kCgojIyBXaHkgYW5kIHdoZW4gd2UgdXNlICoqc3Vydml2YWwgYW5hbHlzaXMqKj8KCj4gUHJpbWFyeSBnb2FscyBvZiBzdXJ2aXZhbCBhbmFseXNpcyAoQEtsZWluYmF1bUJvb2spOgoKMS4gVG8gZXN0aW1hdGUgYW5kIGludGVycHJldCBzdXJ2aXZvciBhbmQvb3IgaGF6YXJkIGZ1bmN0aW9ucyBmcm9tIHN1cnZpdmFsIGRhdGEuCgoyLiBUbyBjb21wYXJlIHN1cnZpdm9yIGFuZC9vciBoYXphcmQgZnVuY3Rpb25zLgoKMy4gVG8gYXNzZXNzIHRoZSByZWxhdGlvbnNoaXAgb2YgZXhwbGFuYXRvcnkgdmFyaWFibGVzIHRvIHN1cnZpdmFsIHRpbWUuCgoKKipUaW1lLXRvLWV2ZW50IGRhdGEgKHN1cnZpdmFsIGRhdGEpIGhhcyB0d28gaW1wb3J0YW50IGZlYXR1cmVzOioqCgoxLiBTdXJ2aXZhbCB0aW1lcyBhcmUgYWxsIHBvc2l0aXZlIChub24tbmVnYXRpdmUpLCB0aHVzIHdlIG1heSBzZWUgbmF0dXJhbGx5IGEgc2tld2VkIChlaXRoZXIgcmlnaHQgb3IgbGVmdCkgZGF0YSBkaXN0cmlidXRpb24uIAoyLiAqKkNlbnNvcmluZyoqOiBTdXJ2aXZhbCB0aW1lcyBvZiBzb21lIG9mIHRoZSBzdHVkeSBwYXJ0aWNpcGFudHMgYXJlIG5vdCBvYnNlcnZlZC4gCiAgICBhLiBFdmVudCBvZiBpbnRlcmVzdCBkaWQgbm90IG9jY3VyIGJlZm9yZSB0aGUgdGVybWluYXRpb24gb2YgdGhlIHN0dWR5IChzdHVkeSBlbmQtcG9pbnQpCiAgICBiLiBQYXJ0aWNpcGFudHMgd2VyZSBsb3N0IGluIHRoZSBmb2xsb3ctdXAKICAgIGMuIFBhcnRpY2lwYW50cyB3aXRoZHJhdyBmcm9tIHRoZSBzdHVkeQoKKipJbiBzdXJ2aXZhbCBhbmFseXNpcywgd2UgYXNzdW1lIHRoYXQgdGhlIGNlbnNvcmluZyBtZWNoYW5pc20gaXMgaW5kZXBlbmRlbnQgdG8gdGhlIHN1cnZpdmFsIG1lY2hhbmlzbSoqCgojIyMgQ2Vuc29yaW5nIAoKVGhlIHRocmVlIGV4YW1wbGVzIGFib3ZlIGZvciB0aGUgY2Vuc29yaW5nIGFyZSBjYWxsZWQgKipyaWdodC1jZW5zb3JpbmcqKiAodHJ1ZSBzdXJ2aXZhbCB0aW1lIGlzIGFib3ZlIGEgY2VydGFpbiB2YWx1ZS8gdHJ1ZSB1bm9ic2VydmVkIGV2ZW50IGlzIHRvIHRoZSByaWdodCBvZiB0aGUgY2Vuc29yaW5nIHRpbWUpLCB3aGljaCBpcyBxdWl0ZSBjb21tb24gaW4gbWFqb3JpdHkgb2YgdGhlIGNsaW5pY2FsIHN0dWRpZXMuIFJpZ2h0IGNlbnNvcmluZyBvY2N1cnMgd2hlbiBhIHN0dWR5IHBhcnRpY2lwYW50IGxlYXZlcyB0aGUgc3R1ZHkgYmVmb3JlIHRoZSBldmVudCBvZiBpbnRlcmVzdCBvY2N1cnMsIG9yIHRoZSBzdHVkeSBlbmRzIGJlZm9yZSB0aGUgZXZlbnQgaGFzIG9jY3VycmVkLgoKW3NvdXJjZTogQEtsZWluYmF1bUJvb2tdKFJpZ2h0Q2Vucy5wbmcpCgoqKkluIHN1cnZpdmFsIGFuYWx5c2lzLCB3ZSBhc3N1bWUgdGhhdCB0aGUgY2Vuc29yaW5nIG1lY2hhbmlzbSBpcyBpbmRlcGVuZGVudCB0byB0aGUgc3Vydml2YWwgbWVjaGFuaXNtKioKCk90aGVyIHR5cGVzIG9mIGNlbnNvcmluZzogCgotKipMZWZ0LWNlbnNvcmluZyoqICh0cnVlIHN1cnZpdmFsIHRpbWUgaXMgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIHRoZSBvYnNlcnZlZCB0aW1lKTogVGhlIGV2ZW50LW9mLWludGVyZXN0IG9jY3VycmVkIGJlZm9yZSB0aGUgc3R1ZHkgZW5kLXBvaW50LCBidXQgZG9uJ3Qga25vdyB0aGUgZXhhY3QgdGltZS4gRm9yIGV4YW1wbGUsIGEgc3R1ZHkgcGFydGljaXBhbnQgaGFzIHRoZSBldmVudCBvZiBkZWF0aCBiZWZvcmUgdGhlIHN0dWR5IGZpbmlzaGVzIChzYXkgYXQgMTAgbW9udGhzIGZyb20gdGhlIHN1cmdlcnkpLCBidXQgdGhlIGV2ZW50IGhhcyBhY3R1YWxseSBvY2N1cnJlZCBiZWZvcmUgdGhhdC4gCgotKipJbnRlcnZhbC1jZW5zb3JpbmcqKiAoc3Vydml2YWwgdGltZSBpcyBiZXR3ZWVuIHR3byB2YWx1ZXMpOiBXaGVuIHdlIGRvbid0IGtub3cgdGhlIGV4YWN0IHRpbWUgb2YgZXZlbnQgb2NjdXJyZW5jZSwgYnV0IGtub3cgdGhhdCBpdCBpcyB3aXRoaW4gYSB0aW1lIGludGVydmFsLiAKCmByIHRleHRfc3BlYygiSW1wb3J0YW5jZSBvZiBjZW5zb3JpbmcgaW4gYW5hbHlzaXM6IiwgYmFja2dyb3VuZCA9ICIjRDA1QTZFIiwgY29sb3IgPSAid2hpdGUiLCBib2xkID0gVClgCgotIEZhaWx1cmUgdG8gYWNjb3VudCBmb3IgdGhlIGNlbnNvcmluZyB3aWxsIGdpdmUgeW91IGJpYXNlZCBwYXJhbWV0ZXIgZXN0aW1hdGVzIGFib3V0IHRoZSBzdXJ2aXZhbCB0aW1lcyBhbmQgdGhlIHJlbGF0ZWQgcXVhbnRpdGllcy4KCi0gU3RhbmRhcmQgbWV0aG9kcyB1c2VkIHRvIGFuYWx5c2Ugc3Vydml2YWwgZGF0YSB3aXRoIGNlbnNvcmVkIG9ic2VydmF0aW9ucyBhcmUgdmFsaWQgb25seSBpZiB0aGUgY2Vuc29yaW5nIGlzICoqbm9uaW5mb3JtYXRpdmUqKi4gSW4gcHJhY3RpY2FsIHRlcm1zLCB0aGlzIG1lYW5zIHRoYXQgY2Vuc29yaW5nIGNhcnJpZXMgbm8gcHJvZ25vc3RpYyBpbmZvcm1hdGlvbiBhYm91dCBzdWJzZXF1ZW50IHN1cnZpdmFsIGV4cGVyaWVuY2U7IGluIG90aGVyIHdvcmRzLCB0aG9zZSB3aG8gYXJlIGNlbnNvcmVkIGJlY2F1c2Ugb2YgbG9zcyB0byBmb2xsb3ctdXAgYXQgYSBnaXZlbiBwb2ludCBpbiB0aW1lIHNob3VsZCBiZSBhcyBsaWtlbHkgdG8gaGF2ZSBhIHN1YnNlcXVlbnQgZXZlbnQgYXMgdGhvc2UgaW5kaXZpZHVhbHMgd2hvIHJlbWFpbiBpbiB0aGUgc3R1ZHkuIFtAQ2xhcmsyMDAzX0ldCgpBIHJlbGF0ZWQgZXhhbXBsZSBvbiBjZW5zb3Jpbmc6Cgpbc291cmNlOiBDbGFyayBldCBhbCwgMjAwM10oQ2Vucy5wbmcpCgojIyMgVHJ1bmNhdGlvbgoKVHJ1bmNhdGlvbiBpcyBkZWZpbmVkIGFzIGEgY29uZGl0aW9uIHdoaWNoIHNjcmVlbnMgY2VydGFpbiBzdWJqZWN0cyBzbyB0aGF0IHRoZSBpbnZlc3RpZ2F0b3Igd2lsbCBub3QgYmUgYXdhcmUgb2YgdGhlaXIgZXhpc3RlbmNlIFtAS2xlaW5Cb29rXS4gICAKCi0qKkxlZnQgdHJ1bmNhdGlvbioqIDogSW4gbGVmdCB0cnVuY2F0aW9uLCBzb21lIChvciBhbGwpIGluZGl2aWR1YWxzIGFyZSBub3QgZm9sbG93ZWQgZnJvbSB0aW1lIHplcm8gKHdpdGggcmVzcGVjdCB0byB0aGUgc3R1ZHkgdGltZSBzY2FsZSksIGJ1dCBvbmx5IGZyb20gbGF0ZXIgZW50cnkgdGltZXMuIAoKW3NvdXJjZTogQE1vb3JlQm9va10oTGVmdFRydW5jLnBuZykKCiMjIyBDZW5zb3JpbmcgdnMgVHJ1bmNhdGlvbgoKPiBDZW5zb3JpbmcgcGVyaW9kIGlzIGRlZmluZWQgYXMgdGhlIHBlcmlvZCB0aGUgc3R1ZHkgcGFydGljaXBhbnQgaXMgbm8gbG9uZ2VyIHVuZGVyIG9ic2VydmF0aW9uLCBidXQgaGUvc2hlICoqbWF5IGV4cGVyaWVuY2UgdGhlIGV2ZW50IG9mIGludGVyZXN0KiouCgo+IFRydW5jYXRpb24gcGVyaW9kIGlzIGRlZmluZWQgYXMgdGhlIHBlcmlvZCB0aGUgc3R1ZHkgcGFydGljaXBhbnQgaXMgbm8gbG9uZ2VyIHVuZGVyIG9ic2VydmF0aW9uLCBidXQgaGUvc2hlICoqY2Fubm90IGV4cGVyaWVuY2UgdGhlIGV2ZW50IG9mIGludGVyZXN0KiouCgoKIyMjIEV4ZXJjaXNlCgoxLiBQcm9zdGF0ZSBjYW5jZXIgcGF0aWVudHMgYXJlIGdpdmVuIGEgZHJ1ZyBvciBwbGFjZWJvLiBTdXJ2aXZhbCB0aW1lIGlzIHRoZSBkdXJhdGlvbiBmcm9tIHJlbWlzc2lvbiB0byByZWxhcHNlLiBUaGUgc3R1ZHkgZW5kcyBhdCAyIHllYXJzIHdpdGggc29tZSBwYXRpZW50cyB5ZXQgdG8gcmVsYXBzZS4gV2hhdCB0eXBlIG9mIGNlbnNvcmluZyBkbyB5b3Ugb2JzZXJ2ZSBmb3IgdGhlc2UgcGFydGljaXBhbnRzPwoKICAgIC0gTGVmdCBjZW5zb3JpbmcKCiAgICAtIEludGVydmFsIGNlbnNvcmluZwoKICAgIC0gUmlnaHQgY2Vuc29yaW5nCgogICAgLSBMZWZ0IHRydW5jYXRpb24KICAKMi4gV2UgYXJlIGludGVyZXN0ZWQgaW4gaWRlbnRpZnlpbmcgcHJvZ25vc3RpYyBmYWN0b3JzIGZvciB0aGUgc3Vydml2YWwgb2Ygb3ZhcmlhbiBjYW5jZXIgcGF0aWVudHMuIE9ubHkgcGF0aWVudHMgd2hvIGhhdmUgc3Vydml2ZWQgYXQgbGVhc3QgNSB5ZWFycyBhZnRlciBkaWFnbm9zaXMgYXJlIGluY2x1ZGVkIGluIHRoZSBzdHVkeS4gVHlwZSBvZiBjZW5zb3JpbmcgaXMKCiAgICAtIExlZnQgY2Vuc29yaW5nCgogICAgLSBJbnRlcnZhbCBjZW5zb3JpbmcKCiAgICAtIFJpZ2h0IGNlbnNvcmluZwoKICAgIC0gTGVmdCB0cnVuY2F0aW9uCiAgCjMuIEZvciBwYXRpZW50cyB3aG8gc3RhcnQgZmVlbGluZyBiZXR0ZXIsIHRoZSBwaHlzaWNpYW5zIGRlY2lkZSB0byBleGNsdWRlIHRoZW0gZnJvbSB0aGUgc3R1ZHkKCiAgICAtIFJpZ2h0IHRydW5jYXRpb24KICAKICAgIC0gUmlnaHQgY2Vuc29yaW5nCiAgCiAgICAtIEluZm9ybWF0aXZlIHJpZ2h0IHRydW5jYXRpb24KICAgIAogICAgLSBJbmZvcm1hdGl2ZSByaWdodCBjZW5zb3JpbmcKICAKIyMgRGVzY3JpYmluZyBzdXJ2aXZhbCBkYXRhOiBzdXJ2aXZhbCAmIGhhemFyZAoKPmByIHRleHRfc3BlYygiU3Vydml2YWwgcHJvYmFiaWxpdHk6IiwgYmFja2dyb3VuZCA9ICIjRDA1QTZFIiwgY29sb3IgPSAid2hpdGUiLCBib2xkID0gVClgIFByb2JhYmlsaXR5IHRoYXQgYSBwYXRpZW50IHN1cnZpdmVzIGZyb20gdGhlIGRpYWdub3NpcyAodGltZSBvZiBvcmlnaW4pIHRpbWUgdG8gYSBzcGVjaWZpYyB0aW1lIHBvaW50ICp0KiAoZGVub3RlZCBieSAqUyh0KSopLgogICAKPmByIHRleHRfc3BlYygiSGF6YXJkIHByb2JhYmlsaXR5OiIsIGJhY2tncm91bmQgPSAiI0QwNUE2RSIsIGNvbG9yID0gIndoaXRlIiwgYm9sZCA9IFQpYCBQcm9iYWJpbGl0eSB0aGF0IGEgcGF0aWVudCB3aWxsIGhhdmUgdGhlIGV2ZW50IG9mIGludGVyZXN0IGF0IHRpbWUgKnQqIChkZW5vdGVkIGJ5ICpoKHQpKiksIGdpdmVuIHRoYXQgdGhlIGluZGl2aWR1YWwgaGFzIHN1cnZpdmVkIHVwIHRvIHRpbWUgKnQqLgoKIyBLYXBsYW4tTWVpZXIgKEtNKSBzdXJ2aXZhbCBlc3RpbWF0ZQoKS00gZXN0aW1hdG9yIChhLmsuYS4gcHJvZHVjdCBsaW1pdCBlc3RpbWF0b3IpIGlzIGEgbm9uLXBhcmFtZXRyaWMgdGVjaG5pcXVlIHRvIGVzdGltYXRlIHRoZSBzdXJ2aXZhbCBwcm9iYWJpbGl0eSBmcm9tIHRoZSBvYnNlcnZlZCBzdXJ2aXZhbCB0aW1lcyAoS2FwbGFuICYgTWVpZXIsIDE5NTgpLiBLTSBtZXRob2QgY291bGQgYmUgdXNlZCB0byBvYnRhaW4gc3Vydml2YWwgaW5mb3JtYXRpb24gb2YgYSBzaW5nbGUgc3R1ZHkgZ3JvdXAgb3IgYmV0d2VlbiBncm91cHMuIExhdGVyIG1lYW5zLCBmb3IgZXhhbXBsZSB3ZSB3YW50IHRvIGNvbXBhcmUgdGhlIHN1cnZpdmFsIHBhdHRlcm4gb2YgdHdvIGdyb3Vwcy4gCgpXZSBjYW4gdXNlIGBzdXJ2aXZhbGAgcGFja2FnZSBpbiBgUmAgdG8gcGVyZm9ybSB0aGUgbWFqb3JpdHkgb2YgdGhlIG1ldGhvZHMgaW4gc3Vydml2YWwgYW5hbHlzaXMgbGl0ZXJhdHVyZS4gQSBrZXkgZnVuY3Rpb24gZm9yIHRoZSBhbmFseXNpcyBvZiBzdXJ2aXZhbCBkYXRhIGluIGBSYCBpcyB0aGUgZnVuY3Rpb24gYFN1cnYoKWAuIFRoaXMgaXMgdXNlZCB0byBzcGVjaWZ5IHRoZSB0eXBlIG9mIHN1cnZpdmFsIGRhdGEgdGhhdCB3ZSB3YW50IHRvIGFuYWx5c2UsIG5hbWVseSwgcmlnaHQgY2Vuc29yZWQsIGxlZnQgY2Vuc29yZWQsIGludGVydmFsIGNlbnNvcmVkLiBGb3Igb3VyIGlsbHVzdHJhdGlvbnMsIHdlIHdpbGwgb25seSBjb25zaWRlciByaWdodCBjZW5zb3JlZCBkYXRhIGluIHRoaXMgd29ya3Nob3AuIAoKVGhlIGBSYCBvYmplY3QgY3JlYXRlZCBieSB1c2luZyB0aGlzIGZ1bmN0aW9uIGlzIGEgICoqc3Vydml2YWwgb2JqZWN0KiouIAoKPiBXaGF0IGlzIGEgKipzdXJ2aXZhbCBvYmplY3QqKiBpbiBgUmA/CgpXZSBkZWNsYXJlIGEgKipzdXJ2aXZhbCBvYmplY3QqKiBpbiBgUmAgdXNpbmcgdGhlIG1pbmltYWwgY29tbWFuZCBgU3Vydih0aW1lLCBldmVudClgLCB3aGVyZQoKLSB0aW1lOiBmb2xsb3ctdXAgdGltZSBmb3IgcmlnaHQtY2Vuc29yZWQgZGF0YQotIGV2ZW50OiBldmVudCBpbmRpY2F0b3IgKHVzdWFsbHkgZGVhZC9hbGl2ZSkgCgojIyBLTSBlc3RpbWF0ZS9jdXJ2ZTogc2luZ2xlIGdyb3VwIHN0dWR5Cgpgc3VydmZpdGAgZnVuY3Rpb24gaW4gdGhlIGBzdXJ2aXZhbGAgcGFja2FnZSBjYW4gYmUgdXNlZCB0byBvYnRhaW4gS00gZXN0aW1hdGUgYW5kIHRvIGNyZWF0ZSBzdXJ2aXZhbCBjdXJ2ZXMuIFRoZSBmaXJzdCBhcmd1bWVudCBvZiB0aGUgYHN1cnZmaXRgIGZ1bmN0aW9uIGlzIGEgZm9ybXVsYSAoJFkgXHNpbSBYJCksIHdoZXJlIGluIHRoZSBsZWZ0LWhhbmQgc2lkZSB3ZSBzdGF0ZSB0aGUgdHlwZSBvZiBzdXJ2aXZhbCBkYXRhIHVzaW5nIHRoZSBmdW5jdGlvbiBgU3VydigpYCBhbmQgaW4gdGhlIHJpZ2h0LWhhbmQgc2lkZSBncm91cGluZyBpbmZvcm1hdGlvbiBhcmUgcHJvdmlkZWQuIAoKPiBXaGF0IGRvIHRoZXNlIGBSYCBjb2RlcyBpbXBseT8KCi0gYHN1cnZmaXQoU3Vydih0aW1lLCBldmVudCkgfiAxKWAKCi0gYHN1cnZmaXQoU3Vydih0aW1lLCBldmVudCkgfiBUcmVhdG1lbnQpYAoKT2suLi4gTGV0J3MgcHV0IGFsbCB0aGVzZSBpbnRvIHByYWN0aWNlIG5vdyEgV2UnbGwgY29uc2lkZXIgdHdvIGV4YW1wbGVzIGZyb20gb3ZhcmlhbiBjYW5jZXIgcmVzZWFyY2guIE9uZSBmcm9tIHRoZSBzdHVkeSB0aGF0IHdhcyBkaXNjdXNzZWQgaW4gW0BFZG1vbnNvbjE5NzldIGFuZCB0aGUgb3RoZXIgZnJvbSBCb3d0ZWxsJ3MgbGFiIFtAQWxzb3BfMjAxMl0uIFRoZSBsYXR0ZXIgc3R1ZHkgd2FzIGRpc2N1c3NlZCBpbiB0aGUgZ3JvdXAgY29tcGFyaXNvbiB3b3Jrc2hvcC4KCiMgQ2FzZSBzdHVkaWVzCiMjIFN0dWR5IDE6IE92YXJpYW4gY2FuY2VyIHN0dWR5IFtARWRtb25zb24xOTc5XQogCldlJ2xsIGJlIHVzaW5nIHRoZSBgb3ZhcmlhbmAgY2FuY2VyIGRhdGEgc2V0IHByb3ZpZGVkIGluIHRoZSBgc3Vydml2YWxgIHBhY2thZ2UgYXMgdGhlIGZpcnN0IGV4YW1wbGUuIFRoaXMgZGF0YSBzZXQgcHJvdmlkZXMgc3Vydml2YWwgaW5mb3JtYXRpb24gaW4gYSByYW5kb21pc2VkIHRyaWFsIGNvbXBhcmluZyB0d28gdHJlYXRtZW50cyBmb3Igb3ZhcmlhbiBjYW5jZXIgW0BFZG1vbnNvbjE5NzldLiBUaGVyZSBhcmUgNiB2YXJpYWJsZXMgaW4gdGhlIGRhdGEgc2V0LiBUaGV5IGFyZToKCjEuIGBmdXRpbWVgIC0gRm9sbG93IHVwIHRpbWUgKHN1cnZpdmFsIHRpbWUpCjIuIGBmdXN0YXRgIC0gRXZlbnQgb2YgaW50ZXJlc3Qgb2NjdXJyZWQgb3IgY2Vuc29yZWQgCjMuIGBhZ2VgIC0gQWdlIG9mIHRoZSBzdHVkeSBwYXJ0aWNpcGFudHMKNC4gYHJlc2lkLmRzYCAtIFJlc2lkdWFsIGRpc2Vhc2Ugc3RhdHVzICgxPW5vLCAyPXllcykKNS4gYHJ4YCAtIFRyZWF0bWVudCBncm91cCAodHdvIHRyZWF0bWVudHMpCjYuIGBlY29nLnBzYCAtIFN0YW5kYXJkaXNlZCBFQ09HIHBlcmZvcm1hbmNlIHN0YXR1cyAoMSBiZWluZyBnb29kIGFuZCAyIGZvciBub3QpCgojIyMgTG9hZGluZyByZXF1aXJlZCBgUmAgcGFja2FnZXMgJiBmdW5jdGlvbnMKCmBgYHtyLCBlY2hvPVQsIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0V9CiMgRnVuY3Rpb24gdG8gaW5zdGFsbCZsb2FkL2xvYWQgcmVxdWlyZWQgUiBwYWNrYWdlcwppbnN0YWxsX2xvYWQgPC0gZnVuY3Rpb24gKHBhY2thZ2UxLCAuLi4pICB7ICAgCiAgcGFja2FnZXMgPC0gYyhwYWNrYWdlMSwgLi4uKQogIGZvcihwYWNrYWdlIGluIHBhY2thZ2VzKXsKICAgIGlmKHBhY2thZ2UgJWluJSByb3duYW1lcyhpbnN0YWxsZWQucGFja2FnZXMoKSkpCiAgICAgIGRvLmNhbGwoJ2xpYnJhcnknLCBsaXN0KHBhY2thZ2UpKQogICAgZWxzZSB7CiAgICAgIGluc3RhbGwucGFja2FnZXMocGFja2FnZSkKICAgICAgZG8uY2FsbCgibGlicmFyeSIsIGxpc3QocGFja2FnZSkpCiAgICB9CiAgfSAKfQoKIyBSZXF1aXJlZCBSIHBhY2thZ2VzCnJlcXVpcmVkX1JfcGFja2FnZXMgPC0gYygic3Vydml2YWwiLCAic3Vydm1pbmVyIiwgInRpZHl2ZXJzZSIsICJwc3ljaCIsIAogICAgICAgICAgICAgICAgICAgICAgICAgInJlYWR4bCIsICJrYWJsZUV4dHJhIikKCiMgSW5zdGFsbC9sb2FkIHJlcXVpcmVkIFIgcGFja2FnZXMKaW5zdGFsbF9sb2FkKHJlcXVpcmVkX1JfcGFja2FnZXMpCmBgYAoKIyMjIExvYWRpbmcgZGF0YSBmcm9tIGBzdXJ2aXZhbGAgcGFja2FnZQoKCmBgYHtyLCBlY2hvPVQsIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0UsIGNvbW1lbnQ9IiJ9CiMgdXNpbmcgdGhlIHN1cnZpdmFsIFIgcGFja2FnZSAKb3Zhcmlhbl9kYXRhIDwtIG92YXJpYW4KCiMgU3RydWN0dXJlIG9mIHlvdXIgZGF0YQpzdHIob3Zhcmlhbl9kYXRhKQoKIyBGYWN0b3Jpc2F0aW9uIG9mIHZhcmlhYmxlcwpvdmFyaWFuX2RhdGEkcnggPC0gZmFjdG9yKG92YXJpYW5fZGF0YSRyeCwgbGV2ZWxzID0gYygiMSIsICIyIikpCm92YXJpYW5fZGF0YSRyZXNpZC5kcyA8LSBmYWN0b3Iob3Zhcmlhbl9kYXRhJHJlc2lkLmRzLCBsZXZlbHMgPSBjKCIxIiwgIjIiKSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWxzID0gYygiTm8iLCAiWWVzIikpCm92YXJpYW5fZGF0YSRlY29nLnBzIDwtIGZhY3RvcihvdmFyaWFuX2RhdGEkZWNvZy5wcywgbGV2ZWxzID0gYygiMSIsICIyIiksIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVscyA9IGMoIkdvb2QiLCAiQmFkIikpCgojIFRha2UgYSBsb29rIGF0IG92YXJpYW4gY2FuY2VyIGRhdGEKZHBseXI6OmdsaW1wc2Uob3Zhcmlhbl9kYXRhKQoKIyBGdW5jdGlvbiB0byBoYXZlIG92ZXJsYXllZCBwbG90cwpwbG90X211bHRpX2hpc3RvZ3JhbSA8LSBmdW5jdGlvbihkZiwgZmVhdHVyZSwgbGFiZWxfY29sdW1uKSB7CiAgICBwbHQgPC0gZ2dwbG90KGRmLCBhZXMoeD1ldmFsKHBhcnNlKHRleHQ9ZmVhdHVyZSkpLCBmaWxsPWV2YWwocGFyc2UodGV4dD1sYWJlbF9jb2x1bW4pKSkpICsKICAgIGdlb21faGlzdG9ncmFtKGFscGhhPTAuNywgcG9zaXRpb249ImlkZW50aXR5IiwgYWVzKHkgPSAuLmRlbnNpdHkuLiksIGNvbG9yPSJibGFjayIpICsKICAgIGdlb21fZGVuc2l0eShhbHBoYT0wLjcpICsKICAgIGxhYnMoeD1mZWF0dXJlLCB5ID0gIkRlbnNpdHkiKQogICAgcGx0ICsgZ3VpZGVzKGZpbGw9Z3VpZGVfbGVnZW5kKHRpdGxlPWxhYmVsX2NvbHVtbikpCn0KCiMgT3ZlcmxheSBwbG90IG9mIGhpc3RvZ3JhbSBhbmQgdGhlIGRlbnNpdGllcyAKcGxvdF9tdWx0aV9oaXN0b2dyYW0ob3Zhcmlhbl9kYXRhLCAnZnV0aW1lJywgJ3J4JykKCiMgRGVzY3JpcHRpdmUgc3RhdGlzdGljcwpkZXNjcmliZUJ5KG92YXJpYW5fZGF0YSRmdXRpbWUsIG92YXJpYW5fZGF0YSRyeCwgbWF0ID0gVClbLWMoMSwgMywgOCwgOSwgMTMsIDE0KV0gJT4lIAprYWJsZShkaWdpdHMgPSAyKSAlPiUgCiAga2FibGVfc3R5bGluZyhib290c3RyYXBfb3B0aW9ucyA9IGMoInN0cmlwZWQiLCAiaG92ZXIiLCAiY29uZGVuc2VkIiksIAogICAgICAgICAgICAgICAgZnVsbF93aWR0aCA9IEYsIAogICAgICAgICAgICAgICAgcG9zaXRpb24gPSAibGVmdCIKICAgICAgICAgICAgICAgICkKYGBgCgojIyMgS00gY3VydmVzCgpgYGB7ciwgZWNobz1ULCBtZXNzYWdlPUZBTFNFLCB3YXJuaW5nPUZBTFNFLCBjb21tZW50PSIifQoKIyBMZXQgdXMgY29udmVydCB0aGUgYFZpdGFsIHN0YXR1c2AgdmFyaWFibGUgdG8gYSBudW1lcmljIHZhcmlhYmxlCm92YXJpYW5fZGF0YSRmdXRpbWUgPC0gYXMubnVtZXJpYyhvdmFyaWFuX2RhdGEkZnV0aW1lKQoKIyBLTSBjdXJ2ZTogcG9vbGluZyBib3RoIGdyb3VwcwpLTV9hbGwgPC0gc3VydmZpdChTdXJ2KGZ1dGltZSwgZnVzdGF0KSB+IDEsIGRhdGEgPSBvdmFyaWFuX2RhdGEpCktNX2FsbAoKIyBBbHRlcm5hdGl2ZWx5CnN1cnZfbWVkaWFuKEtNX2FsbCkKCiMgT2J0YWluaW5nIEtNIGN1cnZlCnBsb3QoS01fYWxsKQoKcGxvdChLTV9hbGwsIHhsYWIgPSAiRnV0aW1lIiwgeWxhYiA9ICJTdXJ2aXZhbCBwcm9iYWJpbGl0eSIsIGJ0eSA9Im4iLCBsd2Q9MiwgCiAgICAgY29sID0gImRhcmtibHVlIiwgbWFpbiA9ICJEZWZhdWx0IHBsb3R0aW5nIG1ldGhvZCIsIGNleC5tYWluID0gMC44KQoKYGBgCmBgYHtyLCBlY2hvPVQsIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0UsIGNvbW1lbnQ9IiJ9CiMgTmljZXIgcGxvdCB3aXRoIG1vcmUgaW5mb3JtYXRpb24gdXNpbmcgc3Vydm1pbmVyIHBhY2thZ2UKZ2dzdXJ2cGxvdChLTV9hbGwsIAogICAgICAgICAgIGRhdGEgPSBvdmFyaWFuX2RhdGEsIAogICAgICAgICAgIGNvbmYuaW50ID0gVCwgCiAgICAgICAgICAgcmlzay50YWJsZSA9IFQsIAogICAgICAgICAgIHN1cnYubWVkaWFuLmxpbmUgPSAiaHYiLCAKICAgICAgICAgICBsZWdlbmQudGl0bGUgPSAiIiwgCiAgICAgICAgICAgbGVnZW5kLmxhYnMgPSBjKCJBbGwiKSwgCiAgICAgICAgICAgeGxhYj0nRnV0aW1lJywgCiAgICAgICAgICAgbGVnZW5kID0gYygwLjYsMC44KQogICAgICAgICAgICkgCgojIFBsb3R0aW5nIHRoZSBoYXphcmQgZnVuY3Rpb24KZ2dzdXJ2cGxvdChLTV9hbGwsIAogICAgICAgICAgIGNvbmYuaW50ID0gVFJVRSwgCiAgICAgICAgICAgcmlzay50YWJsZSA9IFRSVUUsIAogICAgICAgICAgIGZ1biA9ICJjdW1oYXoiCiAgICAgICAgICAgKQpgYGAKCgojIyMgS00gY3VydmVzIGZvciBib3RoIGdyb3VwcwoKYGBge3IsIGVjaG89VCwgbWVzc2FnZT1GQUxTRSwgd2FybmluZz1GQUxTRSwgY29tbWVudD0iIn0KCiMgS00gY3VydmVzIGZvciBib3RoIGdyb3VwcwpLTV9ncm91cHMgPC0gc3VydmZpdChTdXJ2KGZ1dGltZSwgZnVzdGF0KSB+IHJ4LCBkYXRhID0gb3Zhcmlhbl9kYXRhKQpLTV9ncm91cHMKCiMgT2J0YWluaW5nIEtNIGN1cnZlCnBsb3QoS01fZ3JvdXBzLCB4bGFiID0gIk9TRHggKG1vbnRocykiLCB5bGFiID0gIlN1cnZpdmFsIHByb2JhYmlsaXR5IiwgYnR5ID0gIm4iLCAKICAgICBjb2wgPSAiZGFya2JsdWUiLCBtYWluID0gIkRlZmF1bHQgcGxvdHRpbmcgbWV0aG9kIiwgY2V4Lm1haW4gPSAwLjgpCmBgYAoKYGBge3IsIGVjaG89VCwgbWVzc2FnZT1GQUxTRSwgd2FybmluZz1GQUxTRSwgY29tbWVudD0iIn0KCiMgTmljZXIgcGxvdCB3aXRoIG1vcmUgaW5mb3JtYXRpb24gdXNpbmcgc3Vydm1pbmVyIHBhY2thZ2UKZ2dzdXJ2cGxvdChLTV9ncm91cHMsIAogICAgICAgICAgIGRhdGEgPSBvdmFyaWFuX2RhdGEsIAogICAgICAgICAgIGNvbmYuaW50ID0gVCwgCiAgICAgICAgICAgcmlzay50YWJsZSA9IFQsICAKICAgICAgICAgICBzdXJ2Lm1lZGlhbi5saW5lID0gImh2IiwgCiAgICAgICAgICAgbGVnZW5kLnRpdGxlID0gIiIsIAogICAgICAgICAgIGxlZ2VuZC5sYWJzID0gYygiVHJlYXRtZW50IDEiLCAiVHJlYXRtZW50IDIiKSwgCiAgICAgICAgICAgeGxhYj0nRnV0aW1lJywgCiAgICAgICAgICAgbGVnZW5kID0gYygwLjIsMC4yKQogICAgICAgICAgICkgCgojIFBsb3R0aW5nIHRoZSBoYXphcmQgZnVuY3Rpb25zCmdnc3VydnBsb3QoS01fZ3JvdXBzLCAKICAgICAgICAgICBjb25mLmludCA9IFRSVUUsIAogICAgICAgICAgIHJpc2sudGFibGUgPSBUUlVFLCAKICAgICAgICAgICBmdW4gPSAiY3VtaGF6IgogICAgICAgICAgICkKCmBgYAoKIyMgU3R1ZHkgMjogT3ZhcmlhbiBjYW5jZXIgc3R1ZHkgW0BBbHNvcF8yMDEyXQoKV2UnbGwgY29uc2lkZXIgdGhlIG92ZXJhbGwgc3Vydml2YWwgaW5mb3JtYXRpb24gaW4gdGhpcyBzdHVkeS4KCiMjIyBMb2FkaW5nIGRhdGEKYGBge3IsIGVjaG89VCwgbWVzc2FnZT1GQUxTRSwgd2FybmluZz1GQUxTRSwgY29tbWVudD0iIn0KSkNPX29yaWcgPC0gcmVhZHhsOjpyZWFkX2V4Y2VsKCJkYXRhL2RhdGFfa2F0aHJ5bi54bHN4Iiwgc2hlZXQgPSAxKQoKIyBHZXQgYSBnbGltcHNlIG9mIHlvdXIgZGF0YQpnbGltcHNlKEpDT19vcmlnKQoKc3RyKEpDT19vcmlnKQoKIyBSZXBsYWNpbmcgTkFzIHdpdGggIk5lZ2F0aXZlIgpKQ09fZGF0YSA8LSBKQ09fb3JpZyAlPiUgCiAgICAgICAgICAgICAgICByZXBsYWNlX25hKGxpc3QoYEdlbmUgbXV0YXRpb24gZm91bmQgaW5gID0gIk5lZ2F0aXZlIikpCgojIEZhY3RvcmluZyAiR2VuZSBtdXRhdGlvbiBmb3VuZCBpbiIgY29sdW1uCkpDT19kYXRhJGBHZW5lIG11dGF0aW9uIGZvdW5kIGluYCA8LSBmYWN0b3IoSkNPX2RhdGEkYEdlbmUgbXV0YXRpb24gZm91bmQgaW5gKQoKIyBSZXBsYWNpbmcgQlJDQTEgYW5kIEJSQ0EyIGFzIGNvbWJpbmVkIHBvc2l0aXZlCkpDT19kYXRhIDwtIEpDT19kYXRhICU+JSBtdXRhdGUoYEdlbmUgbXV0YXRpb24gZm91bmQgaW5gID0gcmVjb2RlKGBHZW5lIG11dGF0aW9uIGZvdW5kIGluYCwgIkJSQ0ExIj0iQ29tYmluZWRfcG9zaXRpdmUiLCAiQlJDQTIiPSJDb21iaW5lZF9wb3NpdGl2ZSIpKQoKIyBDaGFuZ2luZyB0aGUgY29sdW1uIG5hbWUKbmFtZXMoSkNPX2RhdGEpWzIxXSA8LSAiTXV0YXRpb25fc3RhdHVzIgoKIyBGaWx0ZXJpbmcgb25seSBjb21iaW5lZCBwb3NpdGl2ZSBhbmQgbmVnYXRpdmUgb2JzZXJ2YXRpb25zICYgb25seSBvdmVyYWxsIHN1cnZpdmFsCkpDT19maW5hbCA8LSBKQ09fZGF0YSAlPiUgCiAgICAgICAgICAgICAgICBmaWx0ZXIoTXV0YXRpb25fc3RhdHVzICE9IGMoIlVWIiksIAogICAgICAgICAgICAgICAgICAgICAgIFN0YXR1cyAhPSBjKCJQRiIpKQoKIyBSZXBsYWNpbmcgRCBhbmQgUCB0byAxIChkZWFkKSBhbmQgMCAoYWxpdmUpCkpDT19maW5hbCA8LSBKQ09fZmluYWwgJT4lIG11dGF0ZShTdGF0dXMgPSByZWNvZGUoU3RhdHVzLCAiRCI9MSwgIlAiPTApKQoKIyBHZXR0aW5nIGZpbmFsIGRhdGEgc2V0CkpDT19maW5hbCRNdXRhdGlvbl9zdGF0dXMgPC0gZmFjdG9yKEpDT19maW5hbCRNdXRhdGlvbl9zdGF0dXMpCkpDT19maW5hbCRTdGF0dXMgPC0gYXMubnVtZXJpYyhKQ09fZmluYWwkU3RhdHVzKSAKYGBgCiMjIyBLTSBjdXJ2ZXMgZm9yIGJvdGggZ3JvdXBzCmBgYHtyLCBlY2hvPVQsIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0UsIGNvbW1lbnQ9IiJ9CgojIEtNIGN1cnZlcyBmb3IgYm90aCBncm91cHMKS01fZ3JvdXBzX0Fsc29wIDwtIHN1cnZmaXQoU3VydihPU0R4LCBTdGF0dXMpIH4gTXV0YXRpb25fc3RhdHVzLCBkYXRhID0gSkNPX2ZpbmFsKQpLTV9ncm91cHNfQWxzb3AKCnRhYmxlKEpDT19maW5hbCRTdGF0dXMpCgojIE9idGFpbmluZyBLTSBjdXJ2ZQpnZ3N1cnZwbG90KEtNX2dyb3Vwc19BbHNvcCwgCiAgICAgICAgICAgZGF0YSA9IEpDT19maW5hbCwgCiAgICAgICAgICAgY29uZi5pbnQgPSBULCAKICAgICAgICAgICByaXNrLnRhYmxlID0gVCwgIAogICAgICAgICAgIHN1cnYubWVkaWFuLmxpbmUgPSAiaHYiLCAKICAgICAgICAgICBsZWdlbmQudGl0bGUgPSAiIiwgCiAgICAgICAgICAgbGVnZW5kLmxhYnMgPSBjKCJQb3NpdGl2ZSIsICJOZWdhdGl2ZSIpLCAKICAgICAgICAgICB4bGFiPSdGdXRpbWUnLCAKICAgICAgICAgICBsZWdlbmQgPSBjKDAuMiwwLjIpCiAgICAgICAgICAgKSAKYGBgCgoKU28sIG5vdyB3ZSBrbm93IGhvdyB0byBvYnRhaW4gS00gY3VydmVzIHVzaW5nIGBSYC4gTmV4dCBvYnZpb3VzIHF1ZXN0aW9uIGlzLAoKPiBIb3cgY2FuIHdlIHRlc3QgdGhlIG9ic2VydmVkIGRpZmZlcmVuY2UgaW4gc3Vydml2YWwgaXMgc3RhdGlzdGljYWxseSBzaWduaWZpY2FudCBvciBub3Q/CgpGb3IgdGhpcyBwdXJwb3NlLCB3ZSBjb3VsZCB1c2UgdGhlIHdlbGwgZXN0YWJsaXNoZWQgbG9nLXJhbmsgdGVzdC4gSXQgaXMgYSBzaW1wbGUgdGVzdCB0byBhbnN3ZXIgdGhlIGFib3ZlIHF1ZXN0aW9uLiBXaGF0IGlzIGxvZy1yYW5rIHRlc3Q/CgojIExvZy1yYW5rIHRlc3QKCkxvZy1yYW5rIChNYW50ZWwtSGFlbnN6ZWwpIHRlc3QgaXMgYSBub24tcGFyYW1ldHJpYyBtZXRob2QgZm9yIHRlc3RpbmcgdGhlIGh5cG90aGVzaXM6CgokSF8wIDogZGlzdHJpYnV0aW9uIFw7IG9mIFw7IHN1cnZpdmFsIFw7IHRpbWVzIFw7IGlzIFw7IHRoZSBcOyBzYW1lICBcOyBmb3IgXDsgdGhlIFw7IGdyb3VwcyQgIAoKJEhfMSA6IGl0IFw7IGlzIFw7IG5vdFw7IHRoZSBcOyBzYW1lJCAKClRoaXMgaXMgYSBsYXJnZS1zYW1wbGUgY2hpLXNxdWFyZSB0ZXN0IGFuZCBpdCBwcm92aWRlcyBhbiBvdmVyYWxsIGNvbXBhcmlzb24gb2YgdGhlIEtNIGN1cnZlcyBiZWluZyBjb21wYXJlZC4gVGhlIHRlc3RpbmcgbnVsbCBoeXBvdGhlc2lzIGlzIHRoYXQgdGhlcmUgaXMgbm8gb3ZlcmFsbCBkaWZmZXJlbmNlIGJldHdlZW4gdGhlIHR3byBzdXJ2aXZhbCBjdXJ2ZXMuIFVuZGVyIHRoaXMgbnVsbCBoeXBvdGhlc2lzLCB0aGUgbG9n4oCTcmFuayBzdGF0aXN0aWMgaXMgZGlzdHJpYnV0ZWQgYXBwcm94aW1hdGVseSBjaGktc3F1YXJlIHdpdGggb25lIGRlZ3JlZSBvZiBmcmVlZG9tLiAgCgoqKk5vdGU6KiogCjEuIFRlc3QgaXMgb25seSB2YWxpZCBpZiB0aGUgcmF0aW8gYmV0d2VlbiB0d28gaGF6YXJkcyBvZiB0aGUgZ3JvdXBzIGlzIGEgY29uc3RhbnQhIChwcm9wb3J0aW9uYWwgaGF6YXJkcyBhc3N1bXB0aW9uKQoKMi4gSXQgcGxhY2VzIHRoZSBzYW1lIHdlaWdodCBvbiBhbGwgZm9sbG93LXVwIHRpbWVzCgpUaGUgYHN1cnZpdmFsYCBwYWNrYWdlIHByb3ZpZGVzIHRoZSBmdW5jdGlvbiBgc3VydmRpZmZgIHRvIHBlcmZvcm0gbG9nLXJhbmsgdGVzdHMgZm9yIGRpZmZlcmVuY2VzIGJldHdlZW4gc3Vydml2YWwgY3VydmVzLiBTeW50YXggZm9yIHRoaXMgZnVuY3Rpb24gaXMgcHJldHR5IHNpbWlsYXIgdG8gdGhlIGBzdXJ2Zml0YCBmdW5jdGlvbiB0aGF0IHdlIHVzZWQgZWFybGllci4gCgojIyBDYXNlIHN0dWR5IDEKYGBge3IsIGVjaG89VCwgbWVzc2FnZT1GQUxTRSwgd2FybmluZz1GQUxTRSwgY29tbWVudD0iIn0Kc3VydmRpZmYoU3VydihmdXRpbWUsIGZ1c3RhdCkgfiByeCwgZGF0YSA9IG92YXJpYW5fZGF0YSkKYGBgCldlIG9idGFpbiBhIG5vbi1zaWduaWZpY2FudCBkaWZmZXJlbmNlIGluIHRoZSBzdXJ2aXZhbCBjdXJ2ZXMgYmV0d2VlbiB0aGUgdHdvIHRyZWF0bWVudCBncm91cHMuCgojIyBDYXNlIHN0dWR5IDIKYGBge3IsIGVjaG89VCwgbWVzc2FnZT1GQUxTRSwgd2FybmluZz1GQUxTRSwgY29tbWVudD0iIn0Kc3VydmRpZmYoU3VydihPU0R4LCBTdGF0dXMpIH4gTXV0YXRpb25fc3RhdHVzLCBkYXRhID0gSkNPX2ZpbmFsKQpgYGAKV2Ugb2J0YWluIGEgaGlnaGx5IHNpZ25pZmljYW50IGRpZmZlcmVuY2UgaW4gdGhlIHN1cnZpdmFsIGN1cnZlcyBiZXR3ZWVuIEJSQ0ExLzIgcG9zaXRpdmUgYW5kIG5lZ2F0aXZlIGdyb3Vwcy4KCiMgV2VpZ2h0ZWQgTG9nLXJhbmsgdGVzdHMgCgpXZWlnaHRlZCBMb2ctcmFuayB0ZXN0cyBhcmUgdXNlZnVsIHdoZW4gdGhlIHN0YW5kYXJkIGFzc3VtcHRpb25zIG9mIHRoZSBnZW5lcmFsIExvZy1yYW5rIHRlc3QgYXJlIHZpb2xhdGVkLiAKCiMjIFBldG8gYW5kIFBldG8gbW9kaWZpZWQgR2VoYW4tV2lsY294b24gdGVzdAoKVGhpcyBpcyBhIHZlcnNpb24gb2YgTG9nLXJhbmsgdGVzdCB0aGF0IHNpdHMgYnJvYWRseSB1bmRlciB0aGUgRy1yaG8gZmFtaWx5IG9mIEhhcnJpbmd0b24gYW5kIEZsZW1pbmcgdGVzdHMgKFtASGFycmluZ3RvbjE5ODJdKS4gSXQgaXMgYSBnb29kIGFsdGVybmF0aXZlIHRvIGNvbnNpZGVyIHdoZW46CgotIGhhemFyZCBmdW5jdGlvbnMgYXJlIG5vdCBwcm9wb3J0aW9uYWwKCi0gYmV0dGVyIHdoZW4geW91IGhhdmUgbW9yZSBldmVudCB0aW1lcyBlYXJsaWVyCgpUaGUgUGV0byAmIFBldG8gbW9kaWZpZWQgR2VoYW4tV2lsY294b24gdGVzdCBpcyBhZ2FpbiBjb21wdXRlZCB1c2luZyBmdW5jdGlvbiBgc3VydmRpZmYoKWA7IGhvd2V2ZXIsIHdlIG5lZWQgdG8gc2V0IGFyZ3VtZW50IGByaG9gIHRvIDEuCgpgYGB7ciwgZWNobz1ULCBtZXNzYWdlPUZBTFNFLCB3YXJuaW5nPUZBTFNFLCBjb21tZW50PSIifQpzdXJ2ZGlmZihTdXJ2KGZ1dGltZSwgZnVzdGF0KSB+IHJ4LCByaG8gPSAxLCBkYXRhID0gb3Zhcmlhbl9kYXRhKQpgYGAKClNpbWlsYXIgY29uY2x1c2lvbiBhcyBlYXJsaWVyLgoKCj4gV2hpY2ggb2YgdGhlIDIgdGVzdHMgc2hvdWxkIGJlIHByZWZlcnJlZD8KCi0gaWYgc3Vydml2YWwgY3VydmVzIGNyb3NzLCBib3RoIHRlc3RzIGFyZSBub3Qgb3B0aW1hbAoKLSBjaGVjayBpZiB0aGUgcHJvcG9ydGlvbmFsIGhhemFyZCBhc3N1bXB0aW9uIGlzIHNlcmlvdXNseSB2aW9sYXRlZCAoaGludDogdXNlIHByb3BvcnRpb25hbCBoYXphcmRzIHBsb3QpCgogIC0gTG9nLXJhbmsgdGVzdCBpcyB0aGUgbW9zdCBwb3dlcmZ1bCB0ZXN0IHdoZW4gcHJvcG9ydGlvbmFsaXR5IGFzc3VtcHRpb24gaXMgdmFsaWQKICAKICAtIG90aGVyd2lzZSB1c2UgdGhlIHdlaWdodGVkIG1ldGhvZAoKCiMgU3RyYXRpZmllZCBsb2ctcmFuayB0ZXN0CgpTdHJhdGlmaWVkIGxvZy1yYW5rIHRlc3QgaXMgYW4gZXh0ZW5zaW9uIG9mIHRoZSBsb2ctcmFuayB0ZXN0IHRvIGluY29ycG9yYXRlIGNvbnRyb2xsaW5nIHZhcmlhYmxlKHMpIHRvIHRlc3QgdGhlIGVmZmVjdGl2ZSBkaWZmZXJlbmNlIGJldHdlZW4gc3Vydml2YWwgY3VydmVzIG9mIHRoZSB2YXJpYWJsZSBvZiBpbnRlcmVzdC4gRm9yIGV4YW1wbGUsIGxldCB1cyBhc3N1bWUgdGhhdCB3ZSBoYXZlIHR3byB0cmVhdG1lbnQgZ3JvdXBzIChBICYgQikgYW5kIHdlIHdhbnQgdG8gY29udHJvbCBmb3IgZ2VuZGVyIChtYWxlICYgZmVtYWxlKS4gV2UgbWF5IHVzZSBzdHJhdGlmaWVkIGxvZy1yYW5rIHRlc3QgaW4gdGhpcyBjYXNlIHRvIGFzc2VzcyB0aGUgc2lnbmlmaWNhbmNlIG9mIHRoZSBzdXJ2aXZhbCBjdXJ2ZXMgb2YgdGhlIHR3byB0cmVhdG1lbnQgZ3JvdXBzIGNvbnRyb2xsaW5nIGZvciB0aGUgdmFyaWFibGUgZ2VuZGVyLiBUaHVzLCBpdCBwcm92aWRlcyBhIG1ldGhvZCBvZiB0ZXN0aW5nIHRoZSBlcXVpdmFsZW5jZSBvZiBzdXJ2aXZhbCBjdXJ2ZXMgY29udHJvbGxpbmcgZm9yIHRoZSBzdHJhdGlmaWVkIHZhcmlhYmxlIFtAS2xlaW5Cb29rXS4KCiMjIFBlcmZvcm1pbmcgc3RyYXRpZmllZCBsb2ctcmFuayB0ZXN0CgpgYGB7ciwgZWNobz1ULCBtZXNzYWdlPUZBTFNFLCB3YXJuaW5nPUZBTFNFLCBjb21tZW50PSIifQojIE9idGFpbmluZyBzdXJ2aXZhbCBjdXJ2ZXMKS01fc3RyYXRhIDwtIHN1cnZmaXQoU3VydihPU0R4LCBTdGF0dXMpIH4gTXV0YXRpb25fc3RhdHVzICsgc3RyYXRhKFN1YnR5cGUpLCBkYXRhID0gSkNPX2ZpbmFsKQojS01fc3RyYXRhCgojIFBsb3R0aW5nIEtNIHN1cnZpdmFsIGN1cnZlcwpnZ3N1cnZwbG90KEtNX3N0cmF0YSwgZGF0YSA9IEpDT19maW5hbCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKIyBTdHJhdGlmaWVkIGxvZy1yYW5rIHRlc3QKc3VydmRpZmYoU3VydihPU0R4LCBTdGF0dXMpIH4gTXV0YXRpb25fc3RhdHVzICsgc3RyYXRhKFN1YnR5cGUpLCBkYXRhID0gSkNPX2ZpbmFsKQpgYGAKClRoZSB0ZXN0IHJlc3VsdHMgaW5kaWNhdGUgdGhhdCBldmVuIGFmdGVyIGFkanVzdGluZyBmb3IgdGhlIHBvc3NpYmxlIGNvbmZvdW5kaW5nIHZhcmlhYmxlIFN1YnR5cGUsIHRoZXJlIGlzIGEgc3RhdGlzdGljYWxseSBzaWduaWZpY2FudCBkaWZmZXJlbmNlIGJldHdlZW4gdGhlIHN1cnZpdmFsIGN1cnZlcyBvZiB0aGUgdHdvIGdyb3Vwcy4KCiMgRXhlcmNpc2UKCkNvbnNpZGVyIHRoZSB2YXJpYWJsZSBgcmVzaWQuZHNgIChyZXNpZHVhbCBkaXNlYXNlKSBpbiB0aGUgYG92YXJpYW5gIGRhdGEgc2V0IChjYXNlIHN0dWR5IDEpIHdoZW4gYW5zd2VyaW5nIHRoZSBmb2xsb3dpbmcgcXVlc3Rpb25zLgoKMS4gRHJhdyBLTSBjdXJ2ZXMuIENvbW1lbnQgb24gdGhlIHN1cnZpdmFsIHBhdHRlcm5zIG9mIHRoZSB0d28gZ3JvdXBzIChyZXNpZHVhbCBkaXNlYXNlIFllcyB2cy4gTm8pLgoyLiBJcyB0aGVyZSBhIHNpZ25pZmljYW50IGRpZmZlcmVuY2UgYmV0d2VlbiB0aGUgc3Vydml2YWwgY3VydmVzPyAgCjMuIFBlcmZvcm0gYSBzdHJhdGlmaWVkIGxvZy1yYW5rIHRlc3QgdG8gYXNzZXNzIHRoZSBzdXJ2aXZvciByZWxhdGlvbnNoaXAgYmV0d2VlbiBgcmVzaWQuZHNgIGFuZCBzdXJ2aXZhbCB0aW1lcyBjb250cm9sbGluZyBmb3IgdGhlIHZhcmlhYmxlIGBhZ2VncnBgLiBDb21tZW50IG9uIHRoZSByZXN1bHRzLgoKPGJyIC8+Cgo8ZGV0YWlscz4KPHN1bW1hcnk+KipTZXNzaW9uIEluZm9ybWF0aW9uKio8L3N1bW1hcnk+CmBgYHtyfQpzZXNzaW9uSW5mbygpCmBgYAo8L2RldGFpbHM+CjxiciAvPgoKCiMgUmVmZXJlbmNlcwo=</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("SurvivalAnalysis_I.Rmd");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
